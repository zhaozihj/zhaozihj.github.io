

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="三. Vue 21. Vue 基础1) 环境准备安装脚手架1npm install -g @vue&#x2F;cli   -g 参数表示全局安装，这样在任意目录都可以使用 vue 脚本创建项目  创建项目1vue ui  使用图形向导来创建 vue 项目，如下图，输入项目名  选择手动配置项目  添加 vue router 和 vuex  选择版本，创建项目  安装 devtools devtools 插件">
<meta property="og:type" content="article">
<meta property="og:title" content="vue2">
<meta property="og:url" content="http://example.com/2022/09/29/vue2/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="三. Vue 21. Vue 基础1) 环境准备安装脚手架1npm install -g @vue&#x2F;cli   -g 参数表示全局安装，这样在任意目录都可以使用 vue 脚本创建项目  创建项目1vue ui  使用图形向导来创建 vue 项目，如下图，输入项目名  选择手动配置项目  添加 vue router 和 vuex  选择版本，创建项目  安装 devtools devtools 插件">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/pikaqiu.bmp">
<meta property="article:published_time" content="2022-09-29T15:31:35.000Z">
<meta property="article:modified_time" content="2023-04-10T13:19:46.333Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/pikaqiu.bmp">
  
  
  
  <title>vue2 - Hexo</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"https://zhao1129.oss-cn-qingdao.aliyuncs.com/img/202209301019837.jpeg","onlypost":true,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>java宝库</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="vue2"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-09-29 23:31" pubdate>
          September 29, 2022 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          57k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          478 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">vue2</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="三-Vue-2"><a href="#三-Vue-2" class="headerlink" title="三. Vue 2"></a>三. Vue 2</h1><h2 id="1-Vue-基础"><a href="#1-Vue-基础" class="headerlink" title="1. Vue 基础"></a>1. Vue 基础</h2><h3 id="1-环境准备"><a href="#1-环境准备" class="headerlink" title="1) 环境准备"></a>1) 环境准备</h3><h4 id="安装脚手架"><a href="#安装脚手架" class="headerlink" title="安装脚手架"></a>安装脚手架</h4><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> install -g @vue/cli<br></code></pre></td></tr></table></figure>

<ul>
<li>-g 参数表示全局安装，这样在任意目录都可以使用 vue 脚本创建项目</li>
</ul>
<h4 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">vue ui<br></code></pre></td></tr></table></figure>

<p>使用图形向导来创建 vue 项目，如下图，输入项目名</p>
<p><img src="https://zhao1129.oss-cn-qingdao.aliyuncs.com/img/202303261550155.png" srcset="https://zhao1129.oss-cn-qingdao.aliyuncs.com/img/202209301019837.jpeg" lazyload alt="image-20220815141136895"></p>
<p>选择手动配置项目</p>
<p><img src="https://zhao1129.oss-cn-qingdao.aliyuncs.com/img/202303261550156.png" srcset="https://zhao1129.oss-cn-qingdao.aliyuncs.com/img/202209301019837.jpeg" lazyload alt="image-20220815141312244"></p>
<p>添加 vue router 和 vuex</p>
<p><img src="https://zhao1129.oss-cn-qingdao.aliyuncs.com/img/202303261550157.png" srcset="https://zhao1129.oss-cn-qingdao.aliyuncs.com/img/202209301019837.jpeg" lazyload alt="image-20220815141412380"></p>
<p>选择版本，创建项目</p>
<p><img src="https://zhao1129.oss-cn-qingdao.aliyuncs.com/img/202303261550158.png" srcset="https://zhao1129.oss-cn-qingdao.aliyuncs.com/img/202209301019837.jpeg" lazyload alt="image-20220815141459878"></p>
<h4 id="安装-devtools"><a href="#安装-devtools" class="headerlink" title="安装 devtools"></a>安装 devtools</h4><ul>
<li>devtools 插件网址：<a target="_blank" rel="noopener" href="https://devtools.vuejs.org/guide/installation.html">https://devtools.vuejs.org/guide/installation.html</a></li>
</ul>
<p><img src="https://zhao1129.oss-cn-qingdao.aliyuncs.com/img/202303261550159.png" srcset="https://zhao1129.oss-cn-qingdao.aliyuncs.com/img/202209301019837.jpeg" lazyload alt="image-20220815141648040"></p>
<h4 id="运行项目"><a href="#运行项目" class="headerlink" title="运行项目"></a>运行项目</h4><p>进入项目目录(client目录)，执行</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">npm run serve<br></code></pre></td></tr></table></figure>

<h4 id="修改端口"><a href="#修改端口" class="headerlink" title="修改端口"></a>修改端口</h4><p>前端服务器默认占用了 8080 端口，需要修改一下</p>
<ul>
<li><p>文档地址：<a target="_blank" rel="noopener" href="https://webpack.js.org/configuration/dev-server/#devserverport">DevServer | webpack</a></p>
</li>
<li><p>打开 vue.config.js (<strong>view工程client目录下的文件</strong>)添加</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; defineConfig &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@vue/cli-service&#x27;</span>)<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title function_">defineConfig</span>(&#123;<br>  <br>  <span class="hljs-comment">// ...</span><br>    <br>  <span class="hljs-attr">devServer</span>: &#123;<br>    <span class="hljs-attr">port</span>: <span class="hljs-number">7070</span><br>  &#125;<br>  <br>&#125;)<br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="添加代理"><a href="#添加代理" class="headerlink" title="添加代理"></a>添加代理</h4><p>为了避免前后端服务器联调时， fetch、xhr 请求产生跨域问题，需要配置代理</p>
<ul>
<li><p>文档地址同上</p>
</li>
<li><p>打开 vue.config.js 添加</p>
</li>
<li><p>这个设置就是让所有&#x2F;api开头的请求都走代理走target那个路径，比如正常&#x2F;api&#x2F;a1应该是localhost:7070&#x2F;api&#x2F;a1,但现在实际上上localhost:8080&#x2F;api&#x2F;a1</p>
</li>
<li></li>
<li><p><strong>用代理的话服务器端就不用加那个CrossOrigin注解了</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; defineConfig &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@vue/cli-service&#x27;</span>)<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title function_">defineConfig</span>(&#123;<br>    <br>  <span class="hljs-comment">// ...</span><br>    <br>  <span class="hljs-attr">devServer</span>: &#123;<br>    <span class="hljs-attr">port</span>: <span class="hljs-number">7070</span>,<br>    <span class="hljs-attr">proxy</span>: &#123;<br>      <span class="hljs-string">&#x27;/api&#x27;</span>: &#123;<br>        <span class="hljs-attr">target</span>: <span class="hljs-string">&#x27;http://localhost:8080&#x27;</span>,<br>        <span class="hljs-attr">changeOrigin</span>: <span class="hljs-literal">true</span><br>      &#125;<br>    &#125;<br>  &#125;<br>    <br>&#125;)<br></code></pre></td></tr></table></figure></li>
</ul>
<h4 id="Vue-项目结构"><a href="#Vue-项目结构" class="headerlink" title="Vue 项目结构"></a>Vue 项目结构</h4><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs livescript">PS D:<span class="hljs-string">\2022.js\代码\第3章\client&gt;</span> tree src<br>D:<span class="hljs-string">\2022.JS\代码\第3章\CLIENT\SRC</span><br>├─assets<br>├─components<br>├─router<br>├─store<br>└─views<br></code></pre></td></tr></table></figure>

<ul>
<li>assets - 静态资源</li>
<li>components - 可重用组件</li>
<li>router - 路由</li>
<li>store - 数据共享</li>
<li>views - 视图组件</li>
</ul>
<p>以后还会添加</p>
<ul>
<li>api - 跟后台交互，发送 fetch、xhr 请求，接收响应</li>
<li>plugins - 插件</li>
</ul>
<h3 id="2-Vue-组件"><a href="#2-Vue-组件" class="headerlink" title="2) Vue 组件"></a>2) Vue 组件</h3><p>Vue 的组件文件以 .vue 结尾，每个组件由三部分组成</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;&lt;/template&gt;<br><br>&lt;script&gt;&lt;/script&gt;<br><br>&lt;style&gt;&lt;/style&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>template 模板部分，由它生成 html 代码</li>
<li>script 代码部分，控制模板的数据来源和行为</li>
<li>style 样式部分，一般不咋关心</li>
</ul>
<p>入口组件是 App.vue</p>
<p>先删除原有代码，来个 Hello, World 例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;h1&gt;&#123;&#123;msg&#125;&#125;&lt;/h1&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>const options=&#123;<br><br>  data:  function()&#123;<br>    return &#123;msg: &#x27;你好!&#x27;&#125;;<br>  &#125;<br><br>&#125;;<br>export default options;<br>&lt;/script&gt;<br><br></code></pre></td></tr></table></figure>

<p>解释</p>
<ul>
<li>export default 导出组件对象，供 main.js 导入使用</li>
<li>这个对象有一个 data 方法，返回一个<strong>对象</strong>，给 template 提供数据</li>
<li><code>&#123;&#123;&#125;&#125;</code> 在 Vue 里称之为插值表达式，用来<strong>绑定</strong> data 方法返回的<strong>对象</strong>属性，<strong>绑定</strong>的含义是数据发生变化时，页面显示会同步变化</li>
</ul>
<h4 id="文本插值"><a href="#文本插值" class="headerlink" title="文本插值"></a>文本插值</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;h1&gt;&#123;&#123; name &#125;&#125;&lt;/h1&gt;<br>        &lt;h1&gt;&#123;&#123; age &gt; 60 ? &#x27;老年&#x27; : &#x27;青年&#x27; &#125;&#125;&lt;/h1&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>const options = &#123;<br>    data: function () &#123;<br>        return &#123; name: &#x27;张三&#x27;, age: 70 &#125;;<br>    &#125;<br>&#125;;<br>export default options;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li><code>&#123;&#123;&#125;&#125;</code> 里只能绑定一个属性，绑定多个属性需要用多个 <code>&#123;&#123;&#125;&#125;</code> 分别绑定</li>
<li><strong>template 内只能有一个根元素，所以不能直接写两个h1，得是在div中写两个h1</strong></li>
<li>插值(   <code>&#123;&#123;    &#125;&#125;</code>   )内可以进行简单的表达式计算</li>
</ul>
<h4 id="属性绑定"><a href="#属性绑定" class="headerlink" title="属性绑定"></a>属性绑定</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;div&gt;&lt;input type=&quot;text&quot; v-bind:value=&quot;name&quot;&gt;&lt;/div&gt;<br>        &lt;div&gt;&lt;input type=&quot;date&quot; v-bind:value=&quot;birthday&quot;&gt;&lt;/div&gt;<br>        &lt;div&gt;&lt;input type=&quot;text&quot; :value=&quot;age&quot;&gt;&lt;/div&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>const options = &#123;<br>    data: function () &#123;<br>        return &#123; name: &#x27;王五&#x27;, birthday: &#x27;1995-05-01&#x27;, age: 20 &#125;;<br>    &#125;<br>&#125;;<br>export default options;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>简写方式：可以省略 v-bind 只保留冒号</li>
</ul>
<h4 id="事件绑定"><a href="#事件绑定" class="headerlink" title="事件绑定"></a>事件绑定</h4><p>v-on:click&#x3D;”m1”   是指单击事件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;!-- 事件绑定 --&gt;<br>&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;div&gt;&lt;input type=&quot;button&quot; value=&quot;点我执行m1&quot; v-on:click=&quot;m1&quot;&gt;&lt;/div&gt;<br>        &lt;div&gt;&lt;input type=&quot;button&quot; value=&quot;点我执行m2&quot; @click=&quot;m2&quot;&gt;&lt;/div&gt;<br>        &lt;div&gt;&#123;&#123;count&#125;&#125;&lt;/div&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>const options = &#123;<br>    data: function () &#123;<br>        return &#123; count: 0 &#125;;<br>    &#125;,<br>    methods: &#123;<br>        m1() &#123;<br>            this.count ++;<br>            console.log(&quot;m1&quot;)<br>        &#125;,<br>        m2() &#123;<br>            this.count --;<br>            console.log(&quot;m2&quot;)<br>        &#125;<br>    &#125;<br>&#125;;<br>export default options;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>简写方式：可以把 v-on: 替换为 @</li>
<li>在 methods 方法中的 this 代表的是 data 函数返回的数据对象，也就是整个return后面的{  }这个对象</li>
</ul>
<h4 id="双向绑定"><a href="#双向绑定" class="headerlink" title="双向绑定"></a>双向绑定</h4><p>单选框和多选框正常绑定的属性的值如果和标签value一致，则这个选框会被选中</p>
<p>同时用户改变选择的选框，这个属性的值也会被改变</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;div&gt;<br>            &lt;label for=&quot;&quot;&gt;请输入姓名&lt;/label&gt;<br>            &lt;input type=&quot;text&quot; v-model=&quot;name&quot;&gt;<br>        &lt;/div&gt;<br>        &lt;div&gt;<br>            &lt;label for=&quot;&quot;&gt;请输入年龄&lt;/label&gt;<br>            &lt;input type=&quot;text&quot; v-model=&quot;age&quot;&gt;<br>        &lt;/div&gt;<br>        &lt;div&gt;<br>            &lt;label for=&quot;&quot;&gt;请选择性别&lt;/label&gt;<br>            男 &lt;input type=&quot;radio&quot; value=&quot;男&quot; v-model=&quot;sex&quot;&gt;<br>            女 &lt;input type=&quot;radio&quot; value=&quot;女&quot; v-model=&quot;sex&quot;&gt;<br>        &lt;/div&gt;<br>        &lt;div&gt;<br>            &lt;label for=&quot;&quot;&gt;请选择爱好&lt;/label&gt;<br>            游泳 &lt;input type=&quot;checkbox&quot; value=&quot;游泳&quot; v-model=&quot;fav&quot;&gt;<br>            打球 &lt;input type=&quot;checkbox&quot; value=&quot;打球&quot; v-model=&quot;fav&quot;&gt;<br>            健身 &lt;input type=&quot;checkbox&quot; value=&quot;健身&quot; v-model=&quot;fav&quot;&gt;<br>        &lt;/div&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>const options = &#123;<br>    data: function () &#123;<br>        return &#123; name: &#x27;&#x27;, age: null, sex:&#x27;男&#x27; , fav:[&#x27;打球&#x27;]&#125;;<br>    &#125;,<br>    methods: &#123;<br>    &#125;<br>&#125;;<br>export default options;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>用 v-model 实现双向绑定，即 <ul>
<li>javascript 数据可以同步到表单标签</li>
<li>反过来用户在表单标签输入的新值也会同步到 javascript 这边</li>
</ul>
</li>
<li>双向绑定只适用于表单这种带【输入】功能的标签，其它标签的数据绑定，单向就足够了</li>
<li>复选框这种标签，双向绑定的 javascript 数据类型一般用数组</li>
</ul>
<h4 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;!-- 计算属性 --&gt;<br>&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;h2&gt;&#123;&#123;fullName&#125;&#125;&lt;/h2&gt;<br>        &lt;h2&gt;&#123;&#123;fullName&#125;&#125;&lt;/h2&gt;<br>        &lt;h2&gt;&#123;&#123;fullName&#125;&#125;&lt;/h2&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>const options = &#123;<br>    data: function () &#123;<br>        return &#123; firstName: &#x27;三&#x27;, lastName: &#x27;张&#x27; &#125;;<br>    &#125;,<br>    /* methods: &#123;<br>        fullName() &#123;<br>            console.log(&#x27;进入了 fullName&#x27;)<br>            return this.lastName + this.firstName;<br>        &#125;<br>    &#125;,*/<br>    computed: &#123;<br>        fullName() &#123;<br>            console.log(&#x27;进入了 fullName&#x27;)<br>            return this.lastName + this.firstName;<br>        &#125;<br>    &#125;<br>&#125;;<br>export default options;<br> &lt;/script&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>普通方法调用必须加 ()，没有缓存功能</li>
<li>计算属性使用时就把它当属性来用，不加 ()，有缓存功能：<ul>
<li>一次计算后，会将结果缓存，下次再计算时，只要数据没有变化，不会重新计算，直接返回缓存结果</li>
</ul>
</li>
</ul>
<h4 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h4><p>axios 它的底层是用了 XMLHttpRequest（xhr）方式发送请求和接收响应，xhr 相对于之前讲过的 fetch api 来说，功能更强大，但由于是比较老的 api，不支持 Promise，axios 对 xhr 进行了封装，使之支持 Promise，并提供了对请求、响应的统一拦截功能</p>
<p>安装</p>
<p><strong>以管理员身份运行cmd，然后在client（vue项目）目录下用这个命令</strong></p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">npm install axios -S<br></code></pre></td></tr></table></figure>

<p>导入</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span><br></code></pre></td></tr></table></figure>

<ul>
<li>axios 默认导出一个对象，这里的 import 导入的就是它默认导出的对象</li>
</ul>
<p>方法</p>
<table>
<thead>
<tr>
<th>请求</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>axios.get(url[, config])</td>
<td>:star:</td>
</tr>
<tr>
<td>axios.delete(url[, config])</td>
<td></td>
</tr>
<tr>
<td>axios.head(url[, config])</td>
<td></td>
</tr>
<tr>
<td>axios.options(url[, config])</td>
<td></td>
</tr>
<tr>
<td>axios.post(url[, data[, config]])</td>
<td>:star:</td>
</tr>
<tr>
<td>axios.put(url[, data[, config]])</td>
<td></td>
</tr>
<tr>
<td>axios.patch(url[, data[, config]])</td>
<td></td>
</tr>
</tbody></table>
<ul>
<li>config - 选项对象、例如查询参数、请求头…</li>
<li>data - 请求体数据、最常见的是 json 格式数据</li>
<li>get、head 请求无法携带请求体，这应当是浏览器的限制所致（xhr、fetch api 均有限制）</li>
<li>options、delete 请求可以通过 config 中的 data 携带请求体</li>
</ul>
<p>例子</p>
<p>这段代码中演示的都是同步的请求，因为有这个async和await，要等待请求返回才能接着执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;input type=&quot;button&quot; value=&quot;获取远程数据&quot; @click=&quot;sendReq()&quot;&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>import axios from &#x27;axios&#x27;<br>const options = &#123;<br>    methods: &#123;<br>        async sendReq() &#123;<br>            // 1. 演示 get, post<br>            // const resp = await axios.post(&#x27;/api/a2&#x27;);<br><br>            // 2. 发送请求头<br>            //data没有可以给一个空对象&#123;&#125;<br>            // const resp = await axios.post(&#x27;/api/a3&#x27;,&#123;&#125;,&#123;<br>            //     headers:&#123;<br>            //         Authorization:&#x27;abc&#x27;<br>            //     &#125;<br>            // &#125;);<br><br>            // 3. 发送请求时携带查询参数 ?name=xxx&amp;age=xxx<br>            //如果name是&amp;&amp;&amp;的话，&amp;它是属于特殊字符的，所以要进行一个编码<br>            // const name = encodeURIComponent(&#x27;&amp;&amp;&amp;&#x27;);<br>            // const age = 18;<br>            // const resp = await axios.post(`/api/a4?name=$&#123;name&#125;&amp;age=$&#123;age&#125;`);<br><br>            // 不想自己拼串、处理特殊字符、就用下面的办法<br>            // const resp = await axios.post(&#x27;/api/a4&#x27;, &#123;&#125;, &#123;<br>            //     params: &#123;<br>            //         name:&#x27;&amp;&amp;&amp;&amp;&#x27;,<br>            //         age: 20<br>            //     &#125;<br>            // &#125;);<br><br>            // 4. 用请求体发数据，格式为 urlencoded<br>            //服务器端不需要@RequestBody来接受<br>            // const params = new URLSearchParams();<br>            // params.append(&quot;name&quot;, &quot;张三&quot;);<br>            // params.append(&quot;age&quot;, 24)<br><br>            // const resp = await axios.post(&#x27;/api/a4&#x27;, params);<br><br>            // 5. 用请求体发数据，格式为 multipart<br>             //服务器端不需要@RequestBody来接受<br>            // const params = new FormData();<br>            // params.append(&quot;name&quot;, &quot;李四&quot;);<br>            // params.append(&quot;age&quot;, 30);<br>            // const resp = await axios.post(&#x27;/api/a5&#x27;, params);<br><br>            // 6. 用请求体发数据，格式为 json<br>            //服务器端需要@RequestBody来接受<br>            const resp = await axios.post(&#x27;/api/a5json&#x27;, &#123;<br>                name: &#x27;王五&#x27;,<br>                age: 50<br>            &#125;);<br><br>            console.log(resp);<br>        &#125;<br>    &#125;<br>&#125;;<br>export default options;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>



<p>创建实例</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> _axios = axios.<span class="hljs-title function_">create</span>(config);<br></code></pre></td></tr></table></figure>

<ul>
<li>axios 对象可以直接使用，但使用的是默认的设置</li>
<li>用 axios.create 创建的对象，可以覆盖默认设置，config 见下面说明</li>
</ul>
<p>常见的 config 项有</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>baseURL</td>
<td>将自动加在 url 前面</td>
</tr>
<tr>
<td>headers</td>
<td>请求头，类型为简单对象</td>
</tr>
<tr>
<td>params</td>
<td>跟在 URL 后的请求参数，类型为简单对象或 URLSearchParams</td>
</tr>
<tr>
<td>data</td>
<td>请求体，类型有简单对象、FormData、URLSearchParams、File 等</td>
</tr>
<tr>
<td>withCredentials</td>
<td>跨域时是否携带 Cookie 等凭证，默认为 false</td>
</tr>
<tr>
<td>responseType</td>
<td>响应类型，默认为 json</td>
</tr>
</tbody></table>
<p>例</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> _axios = axios.<span class="hljs-title function_">create</span>(&#123;<br>    <span class="hljs-attr">baseURL</span>: <span class="hljs-string">&#x27;http://localhost:8080&#x27;</span>,<br>    <span class="hljs-attr">withCredentials</span>: <span class="hljs-literal">true</span><br>&#125;);<br><span class="hljs-keyword">await</span> _axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/a6set&#x27;</span>)<br><span class="hljs-keyword">await</span> _axios.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/api/a6get&#x27;</span>)<br></code></pre></td></tr></table></figure>

<ul>
<li>生产环境希望 xhr 请求不走代理，可以用 baseURL 统一修改</li>
<li>希望跨域请求携带 cookie，需要配置 withCredentials: true，服务器也要配置 allowCredentials &#x3D; true，否则浏览器获取跨域返回的 cookie 时会报错</li>
</ul>
<p><img src="https://zhao1129.oss-cn-qingdao.aliyuncs.com/img/202303162028465.png" srcset="https://zhao1129.oss-cn-qingdao.aliyuncs.com/img/202209301019837.jpeg" lazyload alt="image-20230316202834370"></p>
<p>响应格式</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>data</td>
<td>响应体数据 :star:</td>
</tr>
<tr>
<td>status</td>
<td>状态码 :star:</td>
</tr>
<tr>
<td>headers</td>
<td>响应头</td>
</tr>
</tbody></table>
<ul>
<li>200 表示响应成功</li>
<li>400 请求数据不正确 age&#x3D;abc</li>
<li>401 身份验证没通过</li>
<li>403 没有权限</li>
<li>404 资源不存在</li>
<li>405 不支持请求方式 post</li>
<li>500 服务器内部错误</li>
</ul>
<p>请求拦截器</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js">_axios.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(<br>  <span class="hljs-keyword">function</span>(<span class="hljs-params">config</span>) &#123;<br>    <span class="hljs-comment">// 比如在这里添加统一的 headers</span><br>      <span class="hljs-comment">//在请求里面加上指定的请求头</span><br>      config.<span class="hljs-property">headers</span>=&#123;<br>          <span class="hljs-title class_">Authorization</span>: <span class="hljs-string">&#x27;aaa.bbb.ccc&#x27;</span><br>      &#125;<br>    <span class="hljs-keyword">return</span> config;<br>  &#125;,<br>  <span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error);<br>  &#125;<br>);<br></code></pre></td></tr></table></figure>

<p>响应拦截器</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs js">_axios.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(<br>  <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>) &#123;<br>    <span class="hljs-comment">// 2xx 范围内走这里</span><br>    <span class="hljs-keyword">return</span> response;<br>  &#125;,<br>    <span class="hljs-comment">//响应出现异常会走这个函数</span><br>  <span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>) &#123;<br>      <span class="hljs-comment">//可以用来处理报错</span><br>      <span class="hljs-comment">//error中有response响应对象有一个属性叫status</span><br>      <span class="hljs-keyword">if</span>(error.<span class="hljs-property">response</span>.<span class="hljs-property">status</span>===<span class="hljs-number">400</span>)&#123;<br>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;请求参数不正确&#x27;</span>);<br>          <span class="hljs-comment">//这个类似于异常捕捉之后处理了，里面参数可以随便传一个</span><br>          <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">400</span>);<br>      &#125;<br>      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(error.<span class="hljs-property">response</span>.<span class="hljs-property">status</span>===<span class="hljs-number">401</span>)&#123;<br>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;跳转至登录页面&#x27;</span>);<br>          <span class="hljs-comment">//这个类似于异常捕捉之后处理了，里面参数可以随便传一个</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">401</span>);<br>      &#125;<br>      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(error.<span class="hljs-property">response</span>.<span class="hljs-property">status</span>===<span class="hljs-number">404</span>)&#123;<br>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;资源未找到&#x27;</span>);<br>          <span class="hljs-comment">//这个类似于异常捕捉之后处理了，里面参数可以随便传一个</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(<span class="hljs-number">404</span>);<br>      &#125;<br>          <br>      <br>    <span class="hljs-comment">// 超出 2xx, 比如 4xx, 5xx 走这里</span><br>      <span class="hljs-comment">//这里就是抛出异常，异常还是会在控制台显示</span><br>   <span class="hljs-comment">// return Promise.reject(error);</span><br>  &#125;<br>);<br></code></pre></td></tr></table></figure>



<p><strong>将有关axios的创建，以及种种配置单独放在一个js文件中，然后在其他的.vue文件中引入</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs vue">import axios from &#x27;axios&#x27;<br><br>const _axios = axios.create(&#123;<br><br>  // baseURL: &#x27;http://localhost:8080&#x27;,<br><br>  withCredentials: true<br><br>&#125;);<br><br><br><br>// 9. 拦截器<br><br>_axios.interceptors.request.use(<br><br>  function (config) &#123;<br><br>    // 比如在这里添加统一的 headers<br><br>    config.headers = &#123;<br><br>      Authorization: &#x27;aaa.bbb.ccc&#x27;<br><br>    &#125;<br><br>    return config;<br><br>  &#125;,<br><br>  function (error) &#123;<br><br>    return Promise.reject(error);<br><br>  &#125;<br><br>);<br><br><br><br>_axios.interceptors.response.use(<br><br>  function (response) &#123;<br><br>    // 2xx 范围内走这里<br><br>    return response;<br><br>  &#125;,<br><br>  function (error) &#123;<br><br>    if (error.response?.status === 400) &#123;<br><br>      console.log(&#x27;请求参数不正确&#x27;);<br><br>      return Promise.resolve(400);<br><br>    &#125; else if (error.response?.status === 401) &#123;<br><br>      console.log(&#x27;跳转至登录页面&#x27;);<br><br>      return Promise.resolve(401);<br>    &#125; else if (error.response?.status === 404) &#123;<br><br>      console.log(&#x27;资源未找到&#x27;);<br><br>      return Promise.resolve(404);<br><br>    &#125;<br><br>    // 超出 2xx, 比如 4xx, 5xx 走这里<br><br>    return Promise.reject(error);<br><br>  &#125;<br><br>);<br><br><br><br>export default _axios;<br></code></pre></td></tr></table></figure>







<h4 id="条件渲染"><a href="#条件渲染" class="headerlink" title="条件渲染"></a>条件渲染</h4><p><img src="https://zhao1129.oss-cn-qingdao.aliyuncs.com/img/202303201537018.png" srcset="https://zhao1129.oss-cn-qingdao.aliyuncs.com/img/202209301019837.jpeg" lazyload alt="image-20230320153751846"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;input type=&quot;button&quot; value=&quot;获取远程数据&quot; @click=&quot;sendReq()&quot;&gt;<br>        &lt;div class=&quot;title&quot;&gt;学生列表&lt;/div&gt;<br>        &lt;div class=&quot;thead&quot;&gt;<br>            &lt;div class=&quot;row bold&quot;&gt;<br>                &lt;div class=&quot;col&quot;&gt;编号&lt;/div&gt;<br>                &lt;div class=&quot;col&quot;&gt;姓名&lt;/div&gt;<br>                &lt;div class=&quot;col&quot;&gt;性别&lt;/div&gt;<br>                &lt;div class=&quot;col&quot;&gt;年龄&lt;/div&gt;<br>            &lt;/div&gt;<br>        &lt;/div&gt;<br>        &lt;div class=&quot;tbody&quot;&gt;<br>            &lt;!--如果students数组的长度大于零就显示学生书据，否则就是暂无学生数据--&gt;<br>            &lt;div class=&quot;row&quot; v-if=&quot;students.length &gt; 0&quot;&gt;显示学生数据&lt;/div&gt;<br>            &lt;div class=&quot;row&quot; v-else&gt;暂无学生数据&lt;/div&gt;<br>        &lt;/div&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>import axios from &#x27;../util/myaxios&#x27;<br>const options = &#123;<br>    data: function() &#123;<br>        return &#123;<br>            students: []<br>        &#125;;<br>    &#125;,<br>    methods : &#123;<br>        async sendReq() &#123;<br>            const resp = await axios.get(&quot;/api/students&quot;);<br>            //resp.data是那个R对象（R对象既有code，也有data，message属性），resp.data.data才是真正的要返回的java对象<br>            console.log(resp.data.data)<br>            //this是data返回的那个&#123;&#125;对象<br>            this.students = resp.data.data;<br>        &#125;<br>    &#125;<br>&#125;;<br>export default options;<br>&lt;/script&gt;<br>&lt;style scoped&gt;<br>    div &#123;<br>        font-family: 华文行楷;<br>        font-size: 20px;<br>    &#125;<br><br>    .title &#123;<br>        margin-bottom: 10px;<br>        font-size: 30px;<br>        color: #333;<br>        text-align: center;<br>    &#125;<br><br>    .row &#123;<br>        background-color: #fff;<br>        display: flex;<br>        justify-content: center;<br>    &#125;<br><br>    .col &#123;<br>        border: 1px solid #f0f0f0;<br>        width: 15%;<br>        height: 35px;<br>        text-align: center;<br>        line-height: 35px;<br>    &#125;<br><br>    .bold .col &#123;<br>        background-color: #f1f1f1;<br>    &#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure>



<h4 id="列表渲染"><a href="#列表渲染" class="headerlink" title="列表渲染"></a>列表渲染</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;!-- &lt;input type=&quot;button&quot; value=&quot;获取远程数据&quot; @click=&quot;sendReq()&quot;&gt; --&gt;<br>        &lt;div class=&quot;title&quot;&gt;学生列表&lt;/div&gt;<br>        &lt;div class=&quot;thead&quot;&gt;<br>            &lt;div class=&quot;row bold&quot;&gt;<br>                &lt;div class=&quot;col&quot;&gt;编号&lt;/div&gt;<br>                &lt;div class=&quot;col&quot;&gt;姓名&lt;/div&gt;<br>                &lt;div class=&quot;col&quot;&gt;性别&lt;/div&gt;<br>                &lt;div class=&quot;col&quot;&gt;年龄&lt;/div&gt;<br>            &lt;/div&gt;<br>        &lt;/div&gt;<br>        &lt;div class=&quot;tbody&quot;&gt;<br>            &lt;div v-if=&quot;students.length &gt; 0&quot;&gt;<br>                &lt;!--循环，s是students数组中的每 一个元素--&gt;<br>                &lt;!--key属性要和一个元素唯一标识的属性进行绑定--&gt;<br>                &lt;div class=&quot;row&quot; v-for=&quot;s of students&quot; :key=&quot;s.id&quot;&gt;<br>                    &lt;div class=&quot;col&quot;&gt;&#123;&#123;s.id&#125;&#125;&lt;/div&gt;<br>                    &lt;div class=&quot;col&quot;&gt;&#123;&#123;s.name&#125;&#125;&lt;/div&gt;<br>                    &lt;div class=&quot;col&quot;&gt;&#123;&#123;s.sex&#125;&#125;&lt;/div&gt;<br>                    &lt;div class=&quot;col&quot;&gt;&#123;&#123;s.age&#125;&#125;&lt;/div&gt;<br>                &lt;/div&gt;<br>            &lt;/div&gt;<br>            &lt;div class=&quot;row&quot; v-else&gt;暂无学生数据&lt;/div&gt;<br>        &lt;/div&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>import axios from &#x27;../util/myaxios&#x27;<br>const options = &#123;<br>    //mounted方法在组件加载完成(准备就绪)之后就会自动调用<br>    //组件也就是导入的js文件等等<br>    mounted: function()&#123;<br>        //在一个方法中调用另外一个方法，要用this.方法<br>        this.sendReq()<br>    &#125;,<br>    data: function() &#123;<br>        return &#123;<br>            students: []<br>        &#125;;<br>    &#125;,<br>    methods : &#123;<br>        async sendReq() &#123;<br>            const resp = await axios.get(&quot;/api/students&quot;);<br>            console.log(resp.data.data)<br>            this.students = resp.data.data;<br>        &#125;<br>    &#125;<br>&#125;;<br>export default options;<br>&lt;/script&gt;<br>&lt;style scoped&gt;<br>    div &#123;<br>        font-family: 华文行楷;<br>        font-size: 20px;<br>    &#125;<br><br>    .title &#123;<br>        margin-bottom: 10px;<br>        font-size: 30px;<br>        color: #333;<br>        text-align: center;<br>    &#125;<br><br>    .row &#123;<br>        background-color: #fff;<br>        display: flex;<br>        justify-content: center;<br>    &#125;<br><br>    .col &#123;<br>        border: 1px solid #f0f0f0;<br>        width: 15%;<br>        height: 35px;<br>        text-align: center;<br>        line-height: 35px;<br>    &#125;<br><br>    .bold .col &#123;<br>        background-color: #f1f1f1;<br>    &#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>v-if 和 v-for 不能用于同一个标签</li>
<li>v-for 需要配合特殊的标签属性 key 一起使用，并且 key 属性要绑定到一个能起到唯一标识作用的数据上，本例绑定到了学生编号上</li>
<li>options 的 mounted 属性对应一个函数，此函数会在组件挂载后（准备就绪）被调用，可以在它内部发起请求，去获取学生数据</li>
</ul>
<h4 id="重用组件"><a href="#重用组件" class="headerlink" title="重用组件"></a>重用组件</h4><p>按钮组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div class=&quot;button&quot; :class=&quot;[type,size]&quot;&gt;<br>        a&lt;slot&gt;&lt;/slot&gt;b<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>const options = &#123;<br>    props: [&quot;type&quot;, &quot;size&quot;]<br>&#125;;<br>export default options;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>注意，省略了样式部分</li>
</ul>
<p>使用组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;h1&gt;父组件&lt;/h1&gt;<br>        &lt;my-button type=&quot;primary&quot; size=&quot;small&quot;&gt;1&lt;/my-button&gt;<br>        &lt;my-button type=&quot;danger&quot; size=&quot;middle&quot;&gt;2&lt;/my-button&gt;<br>        &lt;my-button type=&quot;success&quot; size=&quot;large&quot;&gt;3&lt;/my-button&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>import MyButton from &#x27;../components/MyButton.vue&#x27;<br>const options = &#123;<br>    components: &#123;<br>        MyButton<br>    &#125;<br>&#125;;<br>export default options;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>



<h2 id="2-Vue-进阶"><a href="#2-Vue-进阶" class="headerlink" title="2. Vue 进阶"></a>2. Vue 进阶</h2><h3 id="1-ElementUI"><a href="#1-ElementUI" class="headerlink" title="1) ElementUI"></a>1) ElementUI</h3><p>安装</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">npm install element-ui -S<br></code></pre></td></tr></table></figure>



<p>引入组件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Element</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;element-ui&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;element-ui/lib/theme-chalk/index.css&#x27;</span><br><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">Element</span>)<br></code></pre></td></tr></table></figure>



<p>测试，在自己的组件中使用 ElementUI 的组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-button&gt;按钮&lt;/el-button&gt;<br></code></pre></td></tr></table></figure>



<h4 id="表格组件"><a href="#表格组件" class="headerlink" title="表格组件"></a>表格组件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;el-table :data=&quot;students&quot;&gt;<br>            &lt;el-table-column label=&quot;编号&quot; prop=&quot;id&quot;&gt;&lt;/el-table-column&gt;<br>            &lt;el-table-column label=&quot;姓名&quot; prop=&quot;name&quot;&gt;&lt;/el-table-column&gt;<br>            &lt;el-table-column label=&quot;性别&quot; prop=&quot;sex&quot;&gt;&lt;/el-table-column&gt;<br>            &lt;el-table-column label=&quot;年龄&quot; prop=&quot;age&quot;&gt;&lt;/el-table-column&gt;<br>        &lt;/el-table&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>import axios from &#x27;../util/myaxios&#x27;<br>const options = &#123;<br>    //async和await保证了这个方法是同步的，等待axios.get请求返回后才能向下执行<br>    async mounted() &#123;<br>        const resp = await axios.get(&#x27;/api/students&#x27;);<br>        this.students = resp.data.data<br>    &#125;,<br>    data() &#123;<br>        return &#123;<br>            students: []<br>        &#125;<br>    &#125;<br>&#125;<br>export default options;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>



<h4 id="分页组件"><a href="#分页组件" class="headerlink" title="分页组件"></a>分页组件</h4><p>加了:的属性其实就是v-bind:  的简写，也就是绑定了javascript中的变量，没加冒号这些等号右边的这些就是它的结果，不会到javascript当中找啦，但是加了:这些就会区javascript中的变量去找</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;el-table v-bind:data=&quot;students&quot;&gt;<br>             &lt;!--prop中填的是学生对象的属性名称--&gt;<br>            &lt;el-table-column label=&quot;编号&quot; prop=&quot;id&quot;&gt;&lt;/el-table-column&gt;<br>            &lt;el-table-column label=&quot;姓名&quot; prop=&quot;name&quot;&gt;&lt;/el-table-column&gt;<br>            &lt;el-table-column label=&quot;性别&quot; prop=&quot;sex&quot;&gt;&lt;/el-table-column&gt;<br>            &lt;el-table-column label=&quot;年龄&quot; prop=&quot;age&quot;&gt;&lt;/el-table-column&gt;<br>        &lt;/el-table&gt;<br>        &lt;!--total是指总记录数是多少--&gt;<br>        &lt;!--page-size是指每页有多少条记录--&gt;<br>        &lt;!--current-page是指当前页是哪一页--&gt;<br>        &lt;!--控制哪些分页小组件(比如pager是页码)显示哪些--&gt;<br>        &lt;!--page-sizes是可以给你一个单选框让你选择一页多少条记录--&gt;<br>        &lt;!--total ,current-page这些前面带:都是先在javascript中找对应属性，找不到的话就把这个值当成表达式解析--&gt;<br>        &lt;!--就是去看total是什么类型，total是number类型，就会把50转换成数字50--&gt;<br>        &lt;!--page-sizes是number[]类型  所以会把等号后面那个看作number[]--&gt;<br>        &lt;!--@current-change和@size-change就是改变当前页的事件和改变一页有多少条记录的事件，可以在element-ui官网查到--&gt;<br>        &lt;el-pagination <br>            :total=&quot;total&quot;<br>            :page-size=&quot;queryDto.size&quot;<br>            :current-page=&quot;queryDto.page&quot;<br>            layout=&quot;prev,pager,next,sizes,-&gt;,total&quot;<br>            :page-sizes=&quot;[5,10,15,20]&quot;<br>            @current-change=&quot;currentChange&quot;<br>            @size-change=&quot;sizeChange&quot;<br>        &gt;&lt;/el-pagination&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>import axios from &#x27;../util/myaxios&#x27;<br>const options = &#123;<br>    mounted() &#123;<br>        this.query();<br>    &#125;,<br>    methods: &#123;<br>        //正常js中变量中page和size变化会引起页面上page和size变化就是:page-size和:current-size的变化<br>        //但是当用户在浏览器页面上切换页的时候，可能不会引起js变量改变，从而页面的显示内容不会改变<br>        //这个方法和下面那个方法就是让用户切换页面或者改变一页有多少数据的时候可以生效<br>        //page参数能捕捉到当前页的值<br>        currentChange(page) &#123;<br>            this.queryDto.page = page;<br>            this.query();<br>        &#125;,<br>        //size参数能捕捉到当前一页有多少条记录<br>        sizeChange(size)&#123;<br>            this.queryDto.size = size;<br>            this.query();<br>        &#125;,<br>        async query() &#123;<br>            const resp = await axios.get(&#x27;/api/students/q&#x27;, &#123;<br>                //params会把参数拼接在url后面，整个&#123;&#125;是一个config对象<br>                //this.queryDto就是有page和size属性，所以可以用this.queryDto给params属性赋值<br>                params: this.queryDto<br>            &#125;);<br>            //resp.data其实是R类也就是一个Dto，resp.data.data才是最主要返回对象，这里是一个map，map里有list和total<br>            this.students = resp.data.data.list;<br>            this.total = resp.data.data.total;<br>        &#125;<br>    &#125;,<br>    data() &#123;<br>        return &#123;<br>            students: [],<br>            total: 0,<br>            queryDto: &#123;<br>                page: 1,<br>                size: 5<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br>export default options;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>三种情况都应该触发查询<ul>
<li>mounted 组件挂载完成后</li>
<li>页号变化时</li>
<li>页大小变化时</li>
</ul>
</li>
<li>查询传参应该根据后台需求，灵活采用不同方式<ul>
<li>本例中因为是 get 请求，无法采用请求体，只能用 params 方式传参</li>
</ul>
</li>
<li>返回响应的格式也许会很复杂，需要掌握【根据返回的响应结构，获取数据】的能力</li>
</ul>
<h4 id="分页搜索"><a href="#分页搜索" class="headerlink" title="分页搜索"></a>分页搜索</h4><p>这些组件都是可以在element-ui上找到的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;!-- ElementUI 表格+分页+条件查询 --&gt;<br>&lt;template&gt;<br>    &lt;div&gt;<br>        &lt;!--size=&quot;mini&quot;目的是为了让输入框变小，placeholder是输入框中的提示内容--&gt;<br>        &lt;!--v-model就是用来双向绑定哪个属性--&gt;<br>        &lt;el-input placeholder=&quot;请输入姓名&quot; size=&quot;mini&quot; v-model=&quot;queryDto.name&quot;&gt;&lt;/el-input&gt;<br>        &lt;!--下拉列表--&gt;<br>        &lt;!--option是给下拉列表提供一些选项，placeholder是框中的提示内容--&gt;<br>        &lt;el-select placeholder=&quot;请选择性别&quot; size=&quot;mini&quot; v-model=&quot;queryDto.sex&quot; clearable&gt;<br>            &lt;el-option value=&quot;男&quot;&gt;&lt;/el-option&gt;<br>            &lt;el-option value=&quot;女&quot;&gt;&lt;/el-option&gt;<br>        &lt;/el-select&gt;<br>        &lt;el-select placeholder=&quot;请选择年龄&quot; size=&quot;mini&quot; v-model=&quot;queryDto.age&quot; clearable&gt;<br>            &lt;!--value会作为最终结果传给后台，label就是给用户看的--&gt;<br>            &lt;el-option value=&quot;0,20&quot; label=&quot;0到20岁&quot;&gt;&lt;/el-option&gt;<br>            &lt;el-option value=&quot;21,30&quot; label=&quot;21到30岁&quot;&gt;&lt;/el-option&gt;<br>            &lt;el-option value=&quot;31,40&quot; label=&quot;31到40岁&quot;&gt;&lt;/el-option&gt;<br>            &lt;el-option value=&quot;41,120&quot; label=&quot;41到120岁&quot;&gt;&lt;/el-option&gt;<br>        &lt;/el-select&gt;<br>        &lt;!--搜索按钮，type=&quot;primary&quot;是那个蓝颜色的按钮--&gt;<br>        &lt;el-button type=&quot;primary&quot; size=&quot;mini&quot; @click=&quot;search()&quot;&gt;搜索&lt;/el-button&gt;<br>        &lt;el-divider&gt;&lt;/el-divider&gt;<br>        &lt;el-table v-bind:data=&quot;students&quot;&gt;<br>            &lt;el-table-column label=&quot;编号&quot; prop=&quot;id&quot;&gt;&lt;/el-table-column&gt;<br>            &lt;el-table-column label=&quot;姓名&quot; prop=&quot;name&quot;&gt;&lt;/el-table-column&gt;<br>            &lt;el-table-column label=&quot;性别&quot; prop=&quot;sex&quot;&gt;&lt;/el-table-column&gt;<br>            &lt;el-table-column label=&quot;年龄&quot; prop=&quot;age&quot;&gt;&lt;/el-table-column&gt;<br>        &lt;/el-table&gt;<br>        &lt;el-pagination :total=&quot;total&quot; :page-size=&quot;queryDto.size&quot; :current-page=&quot;queryDto.page&quot;<br>            layout=&quot;prev,pager,next,sizes,-&gt;,total&quot; :page-sizes=&quot;[5, 10, 15, 20]&quot; @current-change=&quot;currentChange&quot;<br>            @size-change=&quot;sizeChange&quot;&gt;&lt;/el-pagination&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>import axios from &#x27;../util/myaxios&#x27;<br>const options = &#123;<br>    mounted() &#123;<br>        this.query();<br>    &#125;,<br>    methods: &#123;<br>        currentChange(page) &#123;<br>            this.queryDto.page = page;<br>            this.query();<br>        &#125;,<br>        sizeChange(size) &#123;<br>            this.queryDto.size = size;<br>            this.query();<br>        &#125;,<br>        async query() &#123;<br>            const resp = await axios.get(&#x27;/api/students/q&#x27;, &#123;<br>                params: this.queryDto<br>            &#125;);<br>            this.students = resp.data.data.list;<br>            this.total = resp.data.data.total;<br>        &#125;,<br>        search() &#123;<br>            this.query();<br>        &#125;<br>    &#125;,<br>    data() &#123;<br>        return &#123;<br>            students: [],<br>            total: 0,<br>            queryDto: &#123;<br>                //把name和sex以及age和分页的page和size属性都加到queryDto当中，然后传递给后端<br>                name: &#x27;&#x27;,<br>                sex: &#x27;&#x27;,<br>                age: null,  <br>                page: 1,<br>                size: 5<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br>export default options;<br>&lt;/script&gt;<br>&lt;!--下面这个是为了让输入框变小--&gt;<br>&lt;style scoped&gt;<br>.el-input--mini,<br>.el-select--mini &#123;<br>    width: 193px;<br>    margin: 10px 10px 0 0;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>sex 与  age 均用 <code>&#39;&#39;</code> 表示用户没有选择的情况</li>
<li>age 取值 <code>0,20</code> 会被 spring 转换为 <code>new int[]&#123;0, 20&#125;</code></li>
<li>age 取值 <code>&#39;&#39;</code> 会被 spring 转换为 <code>new int[0]</code></li>
</ul>
<h4 id="级联选择"><a href="#级联选择" class="headerlink" title="级联选择"></a>级联选择</h4><p>级联选择器中选项的数据结构为</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;!-- cascader --&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-comment">&lt;!--级联选择器的标签--&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">el-cascader</span> <span class="hljs-attr">:options</span>=<span class="hljs-string">&quot;ops&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">el-cascader</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">const</span> options = &#123;</span></span><br><span class="language-javascript"><span class="language-xml">    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>)&#123;</span></span><br><span class="language-javascript"><span class="language-xml">        <span class="hljs-keyword">return</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-comment">//级联选择器中的各选项，属性children是子项也就是下一级的内容</span></span></span><br><span class="language-javascript"><span class="language-xml">            <span class="hljs-attr">ops</span>:[</span></span><br><span class="language-javascript"><span class="language-xml">                &#123;<span class="hljs-attr">value</span>:<span class="hljs-number">100</span>, <span class="hljs-attr">label</span>:<span class="hljs-string">&#x27;主页&#x27;</span>,<span class="hljs-attr">children</span>:[</span></span><br><span class="language-javascript"><span class="language-xml">                    &#123;<span class="hljs-attr">value</span>:<span class="hljs-number">101</span>, <span class="hljs-attr">label</span>:<span class="hljs-string">&#x27;菜单1&#x27;</span>, <span class="hljs-attr">children</span>:[</span></span><br><span class="language-javascript"><span class="language-xml">                        &#123;<span class="hljs-attr">value</span>:<span class="hljs-number">105</span>, <span class="hljs-attr">label</span>:<span class="hljs-string">&#x27;子项1&#x27;</span>&#125;,</span></span><br><span class="language-javascript"><span class="language-xml">                        &#123;<span class="hljs-attr">value</span>:<span class="hljs-number">106</span>, <span class="hljs-attr">label</span>:<span class="hljs-string">&#x27;子项2&#x27;</span>&#125;</span></span><br><span class="language-javascript"><span class="language-xml">                    ]&#125;,</span></span><br><span class="language-javascript"><span class="language-xml">                    &#123;<span class="hljs-attr">value</span>:<span class="hljs-number">102</span>, <span class="hljs-attr">label</span>:<span class="hljs-string">&#x27;菜单2&#x27;</span>, <span class="hljs-attr">children</span>:[</span></span><br><span class="language-javascript"><span class="language-xml">                        &#123;<span class="hljs-attr">value</span>:<span class="hljs-number">107</span>, <span class="hljs-attr">label</span>:<span class="hljs-string">&#x27;子项3&#x27;</span>&#125;,</span></span><br><span class="language-javascript"><span class="language-xml">                        &#123;<span class="hljs-attr">value</span>:<span class="hljs-number">108</span>, <span class="hljs-attr">label</span>:<span class="hljs-string">&#x27;子项4&#x27;</span>&#125;,</span></span><br><span class="language-javascript"><span class="language-xml">                        &#123;<span class="hljs-attr">value</span>:<span class="hljs-number">109</span>, <span class="hljs-attr">label</span>:<span class="hljs-string">&#x27;子项5&#x27;</span>&#125;</span></span><br><span class="language-javascript"><span class="language-xml">                    ]&#125;,</span></span><br><span class="language-javascript"><span class="language-xml">                    &#123;<span class="hljs-attr">value</span>:<span class="hljs-number">103</span>, <span class="hljs-attr">label</span>:<span class="hljs-string">&#x27;菜单3&#x27;</span>, <span class="hljs-attr">children</span>:[</span></span><br><span class="language-javascript"><span class="language-xml">                        &#123;<span class="hljs-attr">value</span>:<span class="hljs-number">110</span>, <span class="hljs-attr">label</span>:<span class="hljs-string">&#x27;子项6&#x27;</span>&#125;,</span></span><br><span class="language-javascript"><span class="language-xml">                        &#123;<span class="hljs-attr">value</span>:<span class="hljs-number">111</span>, <span class="hljs-attr">label</span>:<span class="hljs-string">&#x27;子项7&#x27;</span>&#125;</span></span><br><span class="language-javascript"><span class="language-xml">                    ]&#125;,</span></span><br><span class="language-javascript"><span class="language-xml">                    &#123;<span class="hljs-attr">value</span>:<span class="hljs-number">104</span>, <span class="hljs-attr">label</span>:<span class="hljs-string">&#x27;菜单4&#x27;</span>&#125;</span></span><br><span class="language-javascript"><span class="language-xml">                ]&#125;</span></span><br><span class="language-javascript"><span class="language-xml">            ] </span></span><br><span class="language-javascript"><span class="language-xml">        &#125;</span></span><br><span class="language-javascript"><span class="language-xml">    &#125;</span></span><br><span class="language-javascript"><span class="language-xml">&#125;;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> options;</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.el-cascader</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">margin</span>: <span class="hljs-number">10px</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">10px</span>;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br><br></code></pre></td></tr></table></figure>

<p>下面的例子是将后端返回的一维数组【树化】</p>
<p>上面是用的常量的例子，下面这个是后端返回的数据然后级联方式显示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;!-- cascader --&gt;<br>&lt;template&gt;<br>    &lt;el-cascader :options=&quot;ops&quot;&gt;&lt;/el-cascader&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>import axios from &#x27;../util/myaxios&#x27;<br>const options = &#123;<br>    async mounted() &#123;<br>        //发送请求获取数据<br>        const resp = await axios.get(&#x27;/api/menu&#x27;)<br>        console.log(resp.data.data)<br>        const array = resp.data.data;<br><br>        const map = new Map(); // get set<br><br>        // 1. 将所有数据存入 map 集合(为了接下来查找效率)<br>        for(const &#123;id,name,pid&#125; of array) &#123;<br>            //以id为key，后面为value，pid是指这条数据它父亲的id，也就是它上一级标签的id<br>            map.set(id, &#123;value:id, label:name, pid:pid&#125;)<br>        &#125;<br>        // console.log(map);<br>        // 2. 建立父子关系<br>        // 3. 找到顶层对象<br>        const top = [];<br>        for(const obj of map.values()) &#123;<br>            // console.log(obj);<br>            //根据pid找到这个标签的父亲<br>            const parent = map.get(obj.pid);<br>            //如果有父亲，不是顶层对象<br>            if(parent !== undefined) &#123;<br>                // if(parent.children === undefined) &#123;<br>                //     parent.children = []<br>                // &#125;<br>                //parent.children如果为null，就赋值一个空数组<br>                parent.children ??= [];<br>                //往children集合中增加儿子，也就是obj对象<br>                parent.children.push(obj);<br>                //如果没有父亲，就是顶层对象<br>            &#125; else &#123;<br>                top.push(obj)<br>            &#125;<br>        &#125;<br>        //把顶层对象给到ops就可以了，可以通过顶层对象找到children来显示所有的对象<br>        this.ops = top;<br>    &#125;,<br>    data()&#123;<br>        return &#123;<br>            ops: []<br>            /* ops:[<br>                &#123;value:100, label:&#x27;主页&#x27;,children:[<br>                    &#123;value:101, label:&#x27;菜单1&#x27;, children:[<br>                        &#123;value:105, label:&#x27;子项1&#x27;&#125;,<br>                        &#123;value:106, label:&#x27;子项2&#x27;&#125;<br>                    ]&#125;,<br>                    &#123;value:102, label:&#x27;菜单2&#x27;, children:[<br>                        &#123;value:107, label:&#x27;子项3&#x27;&#125;,<br>                        &#123;value:108, label:&#x27;子项4&#x27;&#125;,<br>                        &#123;value:109, label:&#x27;子项5&#x27;&#125;<br>                    ]&#125;,<br>                    &#123;value:103, label:&#x27;菜单3&#x27;, children:[<br>                        &#123;value:110, label:&#x27;子项6&#x27;&#125;,<br>                        &#123;value:111, label:&#x27;子项7&#x27;&#125;<br>                    ]&#125;,<br>                    &#123;value:104, label:&#x27;菜单4&#x27;&#125;<br>                ]&#125;<br>            ] */<br>        &#125;<br>    &#125;<br>&#125;;<br>export default options;<br>&lt;/script&gt;<br>&lt;style scoped&gt;<br>.el-cascader &#123;<br>    margin: 10px 0 0 10px;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure>



<h3 id="2-Vue-Router"><a href="#2-Vue-Router" class="headerlink" title="2) Vue-Router"></a>2) Vue-Router</h3><p>vue 属于单页面应用，所谓的路由，就是根据浏览器路径不同，用不同的<strong>视图组件</strong>替换这个页面内容展示,<strong>但还是一个html页面</strong></p>
<h4 id="配置路由"><a href="#配置路由" class="headerlink" title="配置路由"></a>配置路由</h4><p>新建一个路由 js 文件，例如 src&#x2F;router&#x2F;example14.js，内容如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">VueRouter</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span><br><span class="hljs-comment">//把组件引入，@是src的别名</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">ContainerView</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/views/example14/ContainerView.vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">LoginView</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/views/example14/LoginView.vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">NotFoundView</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/views/example14/NotFoundView.vue&#x27;</span><br><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">VueRouter</span>)<br><br><span class="hljs-keyword">const</span> routes = [<br>  &#123;<br>    <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;/&#x27;</span>,<br>    <span class="hljs-attr">component</span>: <span class="hljs-title class_">ContainerView</span><br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;/login&#x27;</span>,<br>    <span class="hljs-attr">component</span>: <span class="hljs-title class_">LoginView</span><br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;/404&#x27;</span>,<br>    <span class="hljs-attr">component</span>: <span class="hljs-title class_">NotFoundView</span><br>  &#125;<br>]<br><br><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VueRouter</span>(&#123;<br>  routes<br>&#125;)<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router<br></code></pre></td></tr></table></figure>

<ul>
<li>最重要的就是建立了【路径】与【视图组件】之间的映射关系</li>
<li>本例中映射了 3 个路径与对应的视图组件</li>
</ul>
<p>在 main.js 中采用我们的路由 js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> e14 <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./views/Example14View.vue&#x27;</span><br><span class="hljs-comment">//之前是&#x27;./router&#x27;默认找的是router文件夹下的index.js</span><br><span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./router/example14&#x27;</span>  <span class="hljs-comment">// 修改这里</span><br><span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./store&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Element</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;element-ui&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;element-ui/lib/theme-chalk/index.css&#x27;</span><br><br><span class="hljs-title class_">Vue</span>.<span class="hljs-property">config</span>.<span class="hljs-property">productionTip</span> = <span class="hljs-literal">false</span><br><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">Element</span>)<br><span class="hljs-keyword">new</span> <span class="hljs-title class_">Vue</span>(&#123;<br>  router,<br>  store,<br>  <span class="hljs-attr">render</span>: <span class="hljs-function"><span class="hljs-params">h</span> =&gt;</span> <span class="hljs-title function_">h</span>(e14)<br>&#125;).$mount(<span class="hljs-string">&#x27;#app&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>根组件是 Example14View.vue，内容为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div class=&quot;all&quot;&gt;<br>        &lt;router-view&gt;&lt;/router-view&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;style scoped&gt;<br>.all &#123;<br>    height: 100%;<br>    background-color: darksalmon;<br>    background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%3E%3Ctext x=&#x27;22&#x27; y=&#x27;10&#x27; font-size=&#x27;14&#x27; font-family=&#x27;system-ui, sans-serif&#x27; text-anchor=&#x27;middle&#x27; dominant-baseline=&#x27;middle&#x27;%3E最外层%3C/text%3E%3C/svg%3E&quot;);<br>    padding: 20px;<br>    box-sizing: border-box;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>样式略</li>
<li>其中 <code>&lt;router-view&gt;</code> 起到占位作用，改变路径后，这个路径对应的视图组件就会占据 <code>&lt;router-view&gt;</code> 的位置，替换掉它之前的内容</li>
</ul>
<h4 id="动态导入"><a href="#动态导入" class="headerlink" title="动态导入"></a>动态导入</h4><p>src&#x2F;router&#x2F;example14.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">VueRouter</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span><br><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">VueRouter</span>)<br><br><span class="hljs-keyword">const</span> routes = [<br>  &#123;<br>    <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;/&#x27;</span>,<br>    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/example14/ContainerView.vue&#x27;</span>)<br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;/login&#x27;</span>,<br>    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/example14/LoginView.vue&#x27;</span>)<br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;/404&#x27;</span>,<br>    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/example14/NotFoundView.vue&#x27;</span>)<br>  &#125;<br>]<br><br><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VueRouter</span>(&#123;<br>  routes<br>&#125;)<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router<br></code></pre></td></tr></table></figure>

<ul>
<li>静态导入是将所有组件的 js 代码打包到一起，如果组件非常多，打包后的 js 文件会很大，影响页面加载速度</li>
<li>动态导入是将组件的 js 代码放入独立的文件，用到时才加载</li>
</ul>
<h4 id="嵌套路由"><a href="#嵌套路由" class="headerlink" title="嵌套路由"></a>嵌套路由</h4><p>src&#x2F;router&#x2F;example14.js</p>
<p>组件内再要切换内容，就需要用到嵌套路由（子路由），下面的例子是在【ContainerView 组件】内定义了 3 个子路由</p>
<p>一个父组件不变，组件中某一块内容要切换，要配置children</p>
<p>children中子路由的路径要和父路由的路径拼接在一起才是他最后的路径</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> routes = [<br>  &#123;<br>    <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;/&#x27;</span>,<br>    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/example14/ContainerView.vue&#x27;</span>),<br>      <span class="hljs-comment">//redirect就是从定向的意思，刚开始访问/ 接下来跳转会转到/c/p1</span><br>    <span class="hljs-attr">redirect</span>: <span class="hljs-string">&#x27;/c/p1&#x27;</span>,<br>    <span class="hljs-attr">children</span>: [<br>      &#123; <br>        <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;c/p1&#x27;</span>,<br>        <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/example14/container/P1View.vue&#x27;</span>)<br>      &#125;,<br>      &#123; <br>        <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;c/p2&#x27;</span>,<br>        <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/example14/container/P2View.vue&#x27;</span>)<br>      &#125;,<br>      &#123; <br>        <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;c/p3&#x27;</span>,<br>        <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/example14/container/P3View.vue&#x27;</span>)<br>      &#125;<br>    ]<br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;/login&#x27;</span>,<br>    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/example14/LoginView.vue&#x27;</span>)<br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;/404&#x27;</span>,<br>    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/example14/NotFoundView.vue&#x27;</span>)<br>  &#125;,<br>    <span class="hljs-comment">//如果上面这些路径都匹配不上,*可以匹配任意路径，然后重定向到/404</span><br>  &#123;<br>    <span class="hljs-attr">path</span>:<span class="hljs-string">&#x27;*&#x27;</span>,<br>    <span class="hljs-attr">redirect</span>: <span class="hljs-string">&#x27;/404&#x27;</span><br>  &#125;<br>]<br></code></pre></td></tr></table></figure>

<p>子路由变化，切换的是【ContainerView 组件】中 <code>&lt;router-view&gt;&lt;/router-view&gt;</code> 部分的内容</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;template&gt;<br>    &lt;div class=<span class="hljs-string">&quot;container&quot;</span>&gt;<br>        &lt;router-view&gt;&lt;/router-view&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>redirect 可以用来重定向（跳转）到一个新的地址</li>
<li>path 的取值为 * 表示匹配不到其它 path 时，就会匹配它</li>
</ul>
<h4 id="ElementUI-布局"><a href="#ElementUI-布局" class="headerlink" title="ElementUI 布局"></a>ElementUI 布局</h4><p>通常主页要做布局，下面的代码是 ElementUI 提供的【上-【左-右】】布局</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div class=&quot;container&quot;&gt;<br>        &lt;el-container&gt;<br>            &lt;el-header&gt;&lt;/el-header&gt;<br>            &lt;el-container&gt;<br>                &lt;!--el-aside是设置左边的内容--&gt;<br>                &lt;el-aside width=&quot;200px&quot;&gt;<br>                    &lt;!--router-link是类似超链接的标签，to的内容是链接，标签中间内容是标签名字--&gt;<br>                    &lt;router-link to=&quot;/c/p1&quot;&gt;P1&lt;/router-link&gt;<br>                    &lt;router-link to=&quot;/c/p2&quot;&gt;P2&lt;/router-link&gt;<br>                    &lt;router-link to=&quot;/c/p3&quot;&gt;P3&lt;/router-link&gt;<br>                  &lt;/el-aside&gt;<br>                &lt;el-main&gt;<br>                    &lt;router-view&gt;&lt;/router-view&gt;<br>                &lt;/el-main&gt;<br>            &lt;/el-container&gt;<br>        &lt;/el-container&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure>



<h4 id="路由跳转"><a href="#路由跳转" class="headerlink" title="路由跳转"></a>路由跳转</h4><h5 id="标签式"><a href="#标签式" class="headerlink" title="标签式"></a>标签式</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-aside width=&quot;200px&quot;&gt;<br>    &lt;router-link to=&quot;/c1/p1&quot;&gt;P1&lt;/router-link&gt;<br>    &lt;router-link to=&quot;/c1/p2&quot;&gt;P2&lt;/router-link&gt;<br>    &lt;router-link to=&quot;/c1/p3&quot;&gt;P3&lt;/router-link&gt;<br>&lt;/el-aside&gt;<br></code></pre></td></tr></table></figure>



<h5 id="编程式"><a href="#编程式" class="headerlink" title="编程式"></a>编程式</h5><p>编程式跳转，type是指这个按钮的样式，el-button是elementui的组件，size属性是让这个按钮小一点</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-header&gt;<br>    &lt;el-button type=&quot;primary&quot; icon=&quot;el-icon-edit&quot; <br>               circle size=&quot;mini&quot; @click=&quot;jump(&#x27;/c1/p1&#x27;)&quot;&gt;&lt;/el-button&gt;<br>    &lt;el-button type=&quot;success&quot; icon=&quot;el-icon-check&quot; <br>               circle size=&quot;mini&quot; @click=&quot;jump(&#x27;/c1/p2&#x27;)&quot;&gt;&lt;/el-button&gt;<br>    &lt;el-button type=&quot;warning&quot; icon=&quot;el-icon-star-off&quot; <br>               circle size=&quot;mini&quot; @click=&quot;jump(&#x27;/c1/p3&#x27;)&quot;&gt;&lt;/el-button&gt;<br>&lt;/el-header&gt;<br></code></pre></td></tr></table></figure>

<p>jump 方法</p>
<p>设计jump方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script&gt;<br>const options = &#123;<br>    methods : &#123;<br>        jump(url) &#123;<br>            //this.$router是一个路由对象，push方法是根据url来跳转<br>            this.$router.push(url);<br>        &#125;<br>    &#125;<br>&#125;<br>export default options;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>其中 this.$router 是拿到路由对象</li>
<li>push 方法根据 url 进行跳转</li>
</ul>
<h5 id="导航菜单"><a href="#导航菜单" class="headerlink" title="导航菜单"></a>导航菜单</h5><p>有子项的时候外层用<el-submenu>标签，内层用<el-menu-item></p>
<p>没有子项的时候都用平行的<el-menu-item>就可以</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;!--backgroud-color和text-color以及active-text-color都是样式属性--&gt;<br>&lt;!--router属性是开启了下面index的功能，跳转的功能--&gt;<br>&lt;el-menu router background-color=&quot;#545c64&quot; text-color=&quot;#fff&quot; active-text-color=&quot;#ffd04b&quot;&gt;<br>    &lt;el-submenu index=&quot;/c1&quot;&gt;<br>        &lt;!--在span里面包裹文字和图标标签，span有个slot属性--&gt;<br>        &lt;!--有span是为了方便加二级标签--&gt;<br>        &lt;span slot=&quot;title&quot;&gt;<br>               &lt;!--i标签是图标标签--&gt;<br>            &lt;i class=&quot;el-icon-platform-eleme&quot;&gt;&lt;/i&gt;<br>            菜单1<br>        &lt;/span&gt;<br>        &lt;!--index属性决定这个标签是否能跳转，以及跳转的路径--&gt;<br>        &lt;el-menu-item index=&quot;/c1/p1&quot;&gt;子项1&lt;/el-menu-item&gt;<br>        &lt;el-menu-item index=&quot;/c1/p2&quot;&gt;子项2&lt;/el-menu-item&gt;<br>        &lt;el-menu-item index=&quot;/c1/p3&quot;&gt;子项3&lt;/el-menu-item&gt;<br>    &lt;/el-submenu&gt;<br>    &lt;el-menu-item index=&quot;/c2&quot;&gt;<br>        &lt;span slot=&quot;title&quot;&gt;<br><br>            &lt;i class=&quot;el-icon-phone&quot;&gt;&lt;/i&gt;<br>            菜单2<br>        &lt;/span&gt;<br>    &lt;/el-menu-item&gt;<br>    &lt;el-menu-item index=&quot;/c3&quot;&gt;<br>        &lt;span slot=&quot;title&quot;&gt;<br>            &lt;i class=&quot;el-icon-star-on&quot;&gt;&lt;/i&gt;<br>            菜单3<br>        &lt;/span&gt;<br>    &lt;/el-menu-item&gt;<br>&lt;/el-menu&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>图标和菜单项文字建议用 <code>&lt;span slot=&#39;title&#39;&gt;&lt;/span&gt;</code> 包裹起来</li>
<li><code>el-menu</code> 标签上加上 <code>router</code> 属性，表示结合导航菜单与路由对象，此时，就可以利用菜单项的 <code>index</code> 属性来路由跳转</li>
</ul>
<h4 id="动态路由与菜单"><a href="#动态路由与菜单" class="headerlink" title="动态路由与菜单"></a>动态路由与菜单</h4><p>将菜单、路由信息（仅主页的）存入数据库中</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> menu(id, name, pid, path, component, icon) <span class="hljs-keyword">values</span><br>    (<span class="hljs-number">101</span>, <span class="hljs-string">&#x27;菜单1&#x27;</span>, <span class="hljs-number">0</span>,   <span class="hljs-string">&#x27;/m1&#x27;</span>,    <span class="hljs-keyword">null</span>,         <span class="hljs-string">&#x27;el-icon-platform-eleme&#x27;</span>),<br>    (<span class="hljs-number">102</span>, <span class="hljs-string">&#x27;菜单2&#x27;</span>, <span class="hljs-number">0</span>,   <span class="hljs-string">&#x27;/m2&#x27;</span>,    <span class="hljs-keyword">null</span>,         <span class="hljs-string">&#x27;el-icon-delete-solid&#x27;</span>),<br>    (<span class="hljs-number">103</span>, <span class="hljs-string">&#x27;菜单3&#x27;</span>, <span class="hljs-number">0</span>,   <span class="hljs-string">&#x27;/m3&#x27;</span>,    <span class="hljs-keyword">null</span>,         <span class="hljs-string">&#x27;el-icon-s-tools&#x27;</span>),<br>    (<span class="hljs-number">104</span>, <span class="hljs-string">&#x27;菜单4&#x27;</span>, <span class="hljs-number">0</span>,   <span class="hljs-string">&#x27;/m4&#x27;</span>,    <span class="hljs-string">&#x27;M4View.vue&#x27;</span>, <span class="hljs-string">&#x27;el-icon-user-solid&#x27;</span>),<br>    (<span class="hljs-number">105</span>, <span class="hljs-string">&#x27;子项1&#x27;</span>, <span class="hljs-number">101</span>, <span class="hljs-string">&#x27;/m1/c1&#x27;</span>, <span class="hljs-string">&#x27;C1View.vue&#x27;</span>, <span class="hljs-string">&#x27;el-icon-s-goods&#x27;</span>),<br>    (<span class="hljs-number">106</span>, <span class="hljs-string">&#x27;子项2&#x27;</span>, <span class="hljs-number">101</span>, <span class="hljs-string">&#x27;/m1/c2&#x27;</span>, <span class="hljs-string">&#x27;C2View.vue&#x27;</span>, <span class="hljs-string">&#x27;el-icon-menu&#x27;</span>),<br>    (<span class="hljs-number">107</span>, <span class="hljs-string">&#x27;子项3&#x27;</span>, <span class="hljs-number">102</span>, <span class="hljs-string">&#x27;/m2/c3&#x27;</span>, <span class="hljs-string">&#x27;C3View.vue&#x27;</span>, <span class="hljs-string">&#x27;el-icon-s-marketing&#x27;</span>),<br>    (<span class="hljs-number">108</span>, <span class="hljs-string">&#x27;子项4&#x27;</span>, <span class="hljs-number">102</span>, <span class="hljs-string">&#x27;/m2/c4&#x27;</span>, <span class="hljs-string">&#x27;C4View.vue&#x27;</span>, <span class="hljs-string">&#x27;el-icon-s-platform&#x27;</span>),<br>    (<span class="hljs-number">109</span>, <span class="hljs-string">&#x27;子项5&#x27;</span>, <span class="hljs-number">102</span>, <span class="hljs-string">&#x27;/m2/c5&#x27;</span>, <span class="hljs-string">&#x27;C5View.vue&#x27;</span>, <span class="hljs-string">&#x27;el-icon-picture&#x27;</span>),<br>    (<span class="hljs-number">110</span>, <span class="hljs-string">&#x27;子项6&#x27;</span>, <span class="hljs-number">103</span>, <span class="hljs-string">&#x27;/m3/c6&#x27;</span>, <span class="hljs-string">&#x27;C6View.vue&#x27;</span>, <span class="hljs-string">&#x27;el-icon-upload&#x27;</span>),<br>    (<span class="hljs-number">111</span>, <span class="hljs-string">&#x27;子项7&#x27;</span>, <span class="hljs-number">103</span>, <span class="hljs-string">&#x27;/m3/c7&#x27;</span>, <span class="hljs-string">&#x27;C7View.vue&#x27;</span>, <span class="hljs-string">&#x27;el-icon-s-promotion&#x27;</span>);<br></code></pre></td></tr></table></figure>

<p>不同的用户查询的的菜单、路由信息是不一样的</p>
<p>例如：访问 <code>/api/menu/admin</code> 返回所有的数据</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">102</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;菜单2&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;icon&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;el-icon-delete-solid&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;path&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/m2&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;pid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;component&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">107</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;子项3&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;icon&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;el-icon-s-marketing&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;path&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/m2/c3&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;pid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">102</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;component&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;C3View.vue&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">108</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;子项4&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;icon&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;el-icon-s-platform&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;path&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/m2/c4&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;pid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">102</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;component&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;C4View.vue&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">109</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;子项5&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;icon&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;el-icon-picture&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;path&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/m2/c5&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;pid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">102</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;component&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;C5View.vue&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure>

<p>访问 <code>/api/menu/wang</code> 返回</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">103</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;菜单3&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;icon&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;el-icon-s-tools&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;path&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/m3&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;pid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;component&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">110</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;子项6&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;icon&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;el-icon-upload&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;path&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/m3/c6&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;pid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">103</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;component&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;C6View.vue&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">111</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;子项7&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;icon&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;el-icon-s-promotion&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;path&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/m3/c7&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;pid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">103</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;component&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;C7View.vue&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">]</span><br></code></pre></td></tr></table></figure>

<p>前端根据他们身份不同，动态添加路由和显示菜单</p>
<h5 id="动态路由"><a href="#动态路由" class="headerlink" title="动态路由"></a>动态路由</h5><p>src&#x2F;router&#x2F;example15.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">addServerRoutes</span>(<span class="hljs-params">array</span>) &#123;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> &#123; id, path, component &#125; <span class="hljs-keyword">of</span> array) &#123;<br>    <span class="hljs-keyword">if</span> (component !== <span class="hljs-literal">null</span>) &#123;<br>      <span class="hljs-comment">// 动态添加路由</span><br>      <span class="hljs-comment">// 参数1：父路由名称</span><br>      <span class="hljs-comment">// 参数2：路由信息对象</span><br>      router.<span class="hljs-title function_">addRoute</span>(<span class="hljs-string">&#x27;c&#x27;</span>, &#123;<br>        <span class="hljs-attr">path</span>: path,<br>        <span class="hljs-attr">name</span>: id,<br>        <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">`@/views/example15/container/<span class="hljs-subst">$&#123;component&#125;</span>`</span>)<br>      &#125;);<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>js 这边只保留几个固定路由，如主页、404 和 login</li>
<li>以上方法执行时，将服务器返回的路由信息加入到名为 c 的父路由中去</li>
<li>这里要注意组件路径，前面 @&#x2F;views 是必须在 js 这边完成拼接的，否则 import 函数会失效</li>
</ul>
<h5 id="重置路由"><a href="#重置路由" class="headerlink" title="重置路由"></a>重置路由</h5><p>src&#x2F;router&#x2F;example15.js</p>
<p>在用户注销时应当重置路由</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">resetRouter</span>(<span class="hljs-params"></span>) &#123;<br>  router.<span class="hljs-property">matcher</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VueRouter</span>(&#123; routes &#125;).<span class="hljs-property">matcher</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="页面刷新"><a href="#页面刷新" class="headerlink" title="页面刷新"></a>页面刷新</h5><p>页面刷新后，会导致动态添加的路由失效，解决方法是将路由数据存入 sessionStorage</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div class=&quot;login&quot;&gt;<br>        &lt;el-input v-model=&quot;username&quot; placeholder=&quot;请输入用户名&quot; size=&quot;mini&quot;&gt;&lt;/el-input&gt;<br>        &lt;el-button type=&quot;primary&quot; size=&quot;mini&quot; @click=&quot;login()&quot;&gt;登录&lt;/el-button&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>import axios from &#x27;@/util/myaxios&#x27;<br>    //@是src，@/router/example15是文件从中导入两个方法重置路由和添加动态路由<br>import &#123;resetRouter, addServerRoutes&#125; from &#x27;@/router/example15&#x27;<br>const options = &#123;<br>    data() &#123;<br>        return &#123;<br>            username: &#x27;admin&#x27;<br>        &#125;<br>    &#125;,<br>    methods: &#123;<br>        async login() &#123;       <br>            resetRouter(); // 重置路由     <br>            const resp = await axios.get(`/api/menu/$&#123;this.username&#125;`)<br>            const array = resp.data.data;<br>            // localStorage     即使浏览器关闭，存储的数据仍在<br>            // sessionStorage   以标签页为单位，关闭标签页时，数据被清除<br>            sessionStorage.setItem(&#x27;serverRoutes&#x27;, JSON.stringify(array))<br>            addServerRoutes(array);<br>            this.$router.push(&#x27;/&#x27;);<br>        &#125;<br>    &#125;<br>&#125;<br>export default options;<br>&lt;/script&gt;<br>&lt;style scoped&gt;<br>.login &#123;<br>    height: 100%;<br>    background-color: darkseagreen;<br>    /* background-image: url(&quot;data:image/svg+xml,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%3E%3Ctext x=&#x27;15&#x27; y=&#x27;10&#x27; font-size=&#x27;14&#x27; font-family=&#x27;system-ui, sans-serif&#x27; text-anchor=&#x27;middle&#x27; dominant-baseline=&#x27;middle&#x27;%3E登录%3C/text%3E%3C/svg%3E&quot;); */<br>&#125;<br><br>.el-input--mini &#123;<br>    width: 193px;<br>    margin: 10px 10px 0 10px;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure>

<p>页面刷新，重新创建路由对象时，从 sessionStorage 里恢复路由数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VueRouter</span>(&#123;<br>  routes<br>&#125;)<br><br><span class="hljs-comment">// 从 sessionStorage 中恢复路由数据</span><br><span class="hljs-keyword">const</span> serverRoutes = sessionStorage.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">&#x27;serverRoutes&#x27;</span>);<br><span class="hljs-keyword">if</span>(serverRoutes) &#123;<br>  <span class="hljs-keyword">const</span> array = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(serverRoutes);<br>  <span class="hljs-title function_">addServerRoutes</span>(array) <span class="hljs-comment">// 动态添加路由</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="动态菜单"><a href="#动态菜单" class="headerlink" title="动态菜单"></a>动态菜单</h5><p>代码部分</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script&gt;<br>const options = &#123;<br>    mounted() &#123;<br>        const serverRoutes = sessionStorage.getItem(&#x27;serverRoutes&#x27;);<br>        const array = JSON.parse(serverRoutes);<br>        const map = new Map();<br>        for(const obj of array) &#123;<br>            map.set(obj.id, obj);<br>        &#125;<br>        const top = [];<br>        for(const obj of array) &#123;<br>            const parent = map.get(obj.pid);<br>            if(parent) &#123;<br>                parent.children ??= [];<br>                parent.children.push(obj);<br>            &#125; else &#123;<br>                top.push(obj);<br>            &#125;<br>        &#125;<br>        this.top = top;<br>    &#125;,<br>    data() &#123;<br>        return &#123;<br>            top: []<br>        &#125;<br>    &#125;<br>&#125;<br>export default options;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<p>菜单部分</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-menu router background-color=&quot;#545c64&quot; text-color=&quot;#fff&quot; active-text-color=&quot;#ffd04b&quot; :unique-opened=&quot;true&quot;&gt;<br>    &lt;template v-for=&quot;m1 of top&quot;&gt;<br>&lt;el-submenu v-if=&quot;m1.children&quot; :key=&quot;m1.id&quot; :index=&quot;m1.path&quot;&gt;<br>    &lt;span slot=&quot;title&quot;&gt;<br>        &lt;i :class=&quot;m1.icon&quot;&gt;&lt;/i&gt; &#123;&#123;m1.name&#125;&#125;<br>        &lt;/span&gt;<br>    &lt;el-menu-item v-for=&quot;m2 of m1.children&quot; :key=&quot;m2.id&quot; :index=&quot;m2.path&quot;&gt;<br>        &lt;span slot=&quot;title&quot;&gt;<br>            &lt;i :class=&quot;m2.icon&quot;&gt;&lt;/i&gt; &#123;&#123;m2.name&#125;&#125;<br>        &lt;/span&gt;<br>        &lt;/el-menu-item&gt;<br>        &lt;/el-submenu&gt;<br>&lt;el-menu-item v-else :key=&quot;m1.id&quot; :index=&quot;m1.path&quot;&gt;<br>    &lt;span slot=&quot;title&quot;&gt;<br>        &lt;i :class=&quot;m1.icon&quot;&gt;&lt;/i&gt; &#123;&#123;m1.name&#125;&#125;<br>        &lt;/span&gt;<br>        &lt;/el-menu-item&gt;<br>    &lt;/template&gt;<br>&lt;/el-menu&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>没有考虑递归菜单问题，认为菜单只有两级</li>
</ul>
<h3 id="3-Vuex"><a href="#3-Vuex" class="headerlink" title="3) Vuex"></a>3) Vuex</h3><h4 id="入门"><a href="#入门" class="headerlink" title="入门"></a>入门</h4><p>vuex 可以在多个组件之间共享数据，并且共享的数据是【响应式】的，即数据的变更能及时渲染到模板</p>
<ul>
<li>与之对比 localStorage 与 sessionStorage 也能共享数据，但缺点是数据并非【响应式】</li>
</ul>
<p>首先需要定义 state 与 mutations 他们一个用来读取共享数据，一个用来修改共享数据</p>
<p>src&#x2F;store&#x2F;index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vuex</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vuex&#x27;</span><br><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">Vuex</span>)<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">  读取数据，走 state, getters</span><br><span class="hljs-comment">  修改数据，走 mutations, actions</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vuex</span>.<span class="hljs-title class_">Store</span>(&#123;<br>  <span class="hljs-attr">state</span>: &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span><br>  &#125;,<br>  <span class="hljs-attr">getters</span>: &#123;<br>  &#125;,<br>  <span class="hljs-attr">mutations</span>: &#123;<br>    <span class="hljs-title function_">updateName</span>(<span class="hljs-params">state, name</span>) &#123;<br>      state.<span class="hljs-property">name</span> = name;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">actions</span>: &#123;<br>  &#125;,<br>  <span class="hljs-attr">modules</span>: &#123;<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>

<p>修改共享数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div class=&quot;p&quot;&gt;<br>        &lt;el-input placeholder=&quot;请修改用户姓名&quot; <br>            size=&quot;mini&quot; v-model=&quot;name&quot;&gt;&lt;/el-input&gt;<br>        &lt;el-button type=&quot;primary&quot; size=&quot;mini&quot; @click=&quot;update()&quot;&gt;修改&lt;/el-button&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>const options = &#123;<br>    methods: &#123;<br>        update()&#123;<br>            this.$store.commit(&#x27;updateName&#x27;, this.name);<br>        &#125;<br>    &#125;,<br>    data () &#123;<br>        return &#123;<br>            name:&#x27;&#x27;<br>        &#125;<br>    &#125;<br>&#125;<br>export default options;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>mutations 方法不能直接调用，只能通过 <code>store.commit(mutation方法名, 参数)</code> 来间接调用</li>
</ul>
<p>读取共享数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div class=&quot;container&quot;&gt;<br>        &lt;el-container&gt;<br>            &lt;el-header&gt;<br>                &lt;div class=&quot;t&quot;&gt;<br>                    欢迎您：&#123;&#123; $store.state.name &#125;&#125;, &#123;&#123; $store.state.age &#125;&#125;<br>    			&lt;/div&gt;<br>            &lt;/el-header&gt;<br>            &lt;el-container&gt;<br>                &lt;el-aside width=&quot;200px&quot;&gt;<br>                &lt;/el-aside&gt;<br>                &lt;el-main&gt;<br>                    &lt;router-view&gt;&lt;/router-view&gt;<br>                &lt;/el-main&gt;<br>            &lt;/el-container&gt;<br>        &lt;/el-container&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure>



<h4 id="mapState"><a href="#mapState" class="headerlink" title="mapState"></a>mapState</h4><p>每次去写 <code>$store.state.name</code> 这样的代码显得非常繁琐，可以用 vuex 帮我们生成计算属性</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div class=&quot;container&quot;&gt;<br>        &lt;el-container&gt;<br>            &lt;el-header&gt;<br>                &lt;div class=&quot;t&quot;&gt;欢迎您：&#123;&#123; name &#125;&#125;, &#123;&#123; age &#125;&#125;&lt;/div&gt;<br>            &lt;/el-header&gt;<br>            &lt;el-container&gt;<br>                &lt;el-aside width=&quot;200px&quot;&gt;<br>                &lt;/el-aside&gt;<br>                &lt;el-main&gt;<br>                    &lt;router-view&gt;&lt;/router-view&gt;<br>                &lt;/el-main&gt;<br>            &lt;/el-container&gt;<br>        &lt;/el-container&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>import &#123; mapState &#125; from &#x27;vuex&#x27;<br>const options = &#123;<br>    computed: &#123;<br>        ...mapState([&#x27;name&#x27;, &#x27;age&#x27;])<br>    &#125;<br>&#125;<br>export default options;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>mapState 返回的是一个对象，对象内包含了 name() 和 age() 的这两个方法作为计算属性</li>
<li>此对象配合 <code>...</code> 展开运算符，填充入 computed 即可使用</li>
</ul>
<h4 id="mapMutations"><a href="#mapMutations" class="headerlink" title="mapMutations"></a>mapMutations</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div class=&quot;p&quot;&gt;<br>        &lt;el-input placeholder=&quot;请修改用户姓名&quot; <br>            size=&quot;mini&quot; v-model=&quot;name&quot;&gt;&lt;/el-input&gt;<br>        &lt;el-button type=&quot;primary&quot; size=&quot;mini&quot; @click=&quot;updateName(name)&quot;&gt;修改&lt;/el-button&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>import &#123;mapMutations&#125; from &#x27;vuex&#x27;<br>const options = &#123;<br>    methods: &#123;<br>        ...mapMutations([&#x27;updateName&#x27;])<br>    &#125;,<br>    data () &#123;<br>        return &#123;<br>            name:&#x27;&#x27;<br>        &#125;<br>    &#125;<br>&#125;<br>export default options;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>类似的，调用 mutation 修改共享数据也可以简化</li>
<li>mapMutations 返回的对象中包含的方法，就会调用 store.commit() 来执行 mutation 方法</li>
<li>注意参数传递略有不同</li>
</ul>
<h4 id="actions"><a href="#actions" class="headerlink" title="actions"></a>actions</h4><p>mutations 方法内不能包括修改不能立刻生效的代码，否则会造成 Vuex 调试工具工作不准确，必须把这些代码写在 actions 方法中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vuex</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vuex&#x27;</span><br><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">Vuex</span>)<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">  读取数据，走 state, getters</span><br><span class="hljs-comment">  修改数据，走 mutations, actions</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/util/myaxios&#x27;</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Vuex</span>.<span class="hljs-title class_">Store</span>(&#123;<br>  <span class="hljs-attr">state</span>: &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span><br>  &#125;,<br>  <span class="hljs-attr">getters</span>: &#123;<br>  &#125;,<br>  <span class="hljs-attr">mutations</span>: &#123;<br>    <span class="hljs-title function_">updateName</span>(<span class="hljs-params">state, name</span>) &#123;<br>      state.<span class="hljs-property">name</span> = name;<br>    &#125;,<br>    <span class="hljs-comment">// 错误的用法，如果在mutations方法中包含了异步操作，会造成开发工具不准确</span><br>    <span class="hljs-comment">/* async updateServerName(state) &#123;</span><br><span class="hljs-comment">      const resp = await axios.get(&#x27;/api/user&#x27;);</span><br><span class="hljs-comment">      const &#123;name, age&#125; = resp.data.data;</span><br><span class="hljs-comment">      state.name = name;</span><br><span class="hljs-comment">      state.age = age;</span><br><span class="hljs-comment">    &#125; */</span><br>    <span class="hljs-title function_">updateServerName</span>(<span class="hljs-params">state, user</span>) &#123;<br>      <span class="hljs-keyword">const</span> &#123; name, age &#125; = user;<br>      state.<span class="hljs-property">name</span> = name;<br>      state.<span class="hljs-property">age</span> = age;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">actions</span>: &#123;<br>    <span class="hljs-keyword">async</span> <span class="hljs-title function_">updateServerName</span>(<span class="hljs-params">context</span>) &#123;<br>      <span class="hljs-keyword">const</span> resp = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/api/user&#x27;</span>);<br>      context.<span class="hljs-title function_">commit</span>(<span class="hljs-string">&#x27;updateServerName&#x27;</span>, resp.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>)<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">modules</span>: &#123;<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>

<ul>
<li>首先应当调用 actions 的 updateServerName 获取数据</li>
<li>然后再由它间接调用 mutations 的 updateServerName 更新共享数据</li>
</ul>
<p>页面使用 actions 的方法可以这么写</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>    &lt;div class=&quot;p&quot;&gt;<br>        &lt;el-button type=&quot;primary&quot; size=&quot;mini&quot;<br>            @click=&quot;updateServerName()&quot;&gt;从服务器获取数据,存入store&lt;/el-button&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>import &#123; mapActions &#125; from &#x27;vuex&#x27;<br>const options = &#123;<br>    methods: &#123;<br>        ...mapActions([&#x27;updateServerName&#x27;])<br>    &#125;<br>&#125;<br>export default options;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li><p>mapActions 会生成调用 actions 中方法的代码</p>
</li>
<li><p>调用 actions 的代码内部等价于，它返回的是 Promise 对象，可以用同步或异步方式接收结果</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">$store</span>.<span class="hljs-title function_">dispatch</span>(<span class="hljs-string">&#x27;action名称&#x27;</span>, 参数)<br></code></pre></td></tr></table></figure></li>
</ul>
<h2 id="3-Vue-实战"><a href="#3-Vue-实战" class="headerlink" title="3. Vue 实战"></a>3. Vue 实战</h2><p>课程不准备从头开发一个 Vue 项目，这里我准备采用这样的教学方法：带着大家看一个较为典型的基于 Vue 的项目实现，分析其中几个重点流程</p>
<p>这里选择了 vue-element-admin 这个项目骨架，它采用的技术与我们之前学过的较为契合</p>
<ul>
<li>vue 2</li>
<li>element-ui 2</li>
<li>vue-router 3</li>
<li>vuex 3</li>
<li>axios</li>
</ul>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cmd">git clone https://gitee.com/panjiachen/vue-element-admin.git client-action<br><br><span class="hljs-built_in">cd</span> client-action<br><br>git branch -a<br><br>git checkout -b i18n remotes/origin/i18n<br><br>git config --global url.&quot;https://&quot;.insteadOf git://<br><br>npm install<br><br>npm run dev<br></code></pre></td></tr></table></figure>

<ul>
<li>需要切换分支到 i18n，否则不支持国际化（中文）功能</li>
<li>npm install 要多试几次，因为中间会连接 gitbub 下载一些依赖，网络不稳定会导致失败</li>
<li>npm run dev 运行后回自动打开浏览器，使用的端口是 9527</li>
</ul>
<h3 id="后端路径"><a href="#后端路径" class="headerlink" title="后端路径"></a>后端路径</h3><p>开发环境下执行下面命令</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">npm <span class="hljs-built_in">run</span> dev<br></code></pre></td></tr></table></figure>

<ul>
<li>会同时启动 mock-server</li>
</ul>
<p>在开发环境下，后端访问路径起始路径配置在文件 <code>.env.development</code> 中</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">VUE_APP_BASE_API</span> = <span class="hljs-string">&#x27;/dev-api&#x27;</span><br></code></pre></td></tr></table></figure>

<ul>
<li>默认向后台的请求都发给 <code>http://localhost:9527/dev-api</code> 的 mock-server 获得的都是模拟数据</li>
<li>需要跟真实后台联调时，可以改动以上地址为 <code>VUE_APP_BASE_API = &#39;http://localhost:8080/api&#39;</code></li>
</ul>
<p>发送请求的 axios 工具被封装在 src&#x2F;utils&#x2F;request.js 中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">MessageBox</span>, <span class="hljs-title class_">Message</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;element-ui&#x27;</span><br><span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/store&#x27;</span><br><span class="hljs-keyword">import</span> &#123; getToken &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/utils/auth&#x27;</span><br><br><span class="hljs-comment">// create an axios instance</span><br><span class="hljs-keyword">const</span> service = axios.<span class="hljs-title function_">create</span>(&#123;<br>  <span class="hljs-attr">baseURL</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">VUE_APP_BASE_API</span>, <span class="hljs-comment">// url = base url + request url</span><br>  <span class="hljs-comment">// withCredentials: true, // send cookies when cross-domain requests</span><br>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">5000</span> <span class="hljs-comment">// request timeout</span><br>&#125;)<br><br><span class="hljs-comment">// ...</span><br></code></pre></td></tr></table></figure>

<p>原有代码的 URI 路径都是这样的：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/vue-element-admin/u</span>ser/login<br><span class="hljs-regexp">/vue-element-admin/u</span>ser/info<br><span class="hljs-regexp">/vue-element-admin/u</span>ser/logout<br>...<br></code></pre></td></tr></table></figure>

<p>如果觉得不爽，可以来一个全局替换</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/user/</span>login<br><span class="hljs-regexp">/user/i</span>nfo<br><span class="hljs-regexp">/user/</span>logout<br>...<br></code></pre></td></tr></table></figure>

<p>token 的请求头修改一下，在 src&#x2F;utils&#x2F;request.js 中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js">...<br>service.<span class="hljs-property">interceptors</span>.<span class="hljs-property">request</span>.<span class="hljs-title function_">use</span>(<br>  <span class="hljs-function"><span class="hljs-params">config</span> =&gt;</span> &#123;<br>    <span class="hljs-comment">// do something before request is sent</span><br><br>    <span class="hljs-keyword">if</span> (store.<span class="hljs-property">getters</span>.<span class="hljs-property">token</span>) &#123;<br>      <span class="hljs-comment">// let each request carry token</span><br>      <span class="hljs-comment">// [&#x27;X-Token&#x27;] is a custom headers key</span><br>      <span class="hljs-comment">// please modify it according to the actual situation</span><br>      config.<span class="hljs-property">headers</span>[<span class="hljs-string">&#x27;Authorization&#x27;</span>] = <span class="hljs-title function_">getToken</span>()<br>    &#125;<br>    <span class="hljs-keyword">return</span> config<br>  &#125;,<br>  <span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;<br>    <span class="hljs-comment">// do something with request error</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error) <span class="hljs-comment">// for debug</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(error)<br>  &#125;<br>)<br>...<br></code></pre></td></tr></table></figure>



<h3 id="登录流程"><a href="#登录流程" class="headerlink" title="登录流程"></a>登录流程</h3><h4 id="1-src-views-login-index-vue"><a href="#1-src-views-login-index-vue" class="headerlink" title="1. src/views/login/index.vue"></a>1. <code>src/views/login/index.vue</code></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script&gt;<br>import &#123; validUsername &#125; from &#x27;@/utils/validate&#x27;<br>import LangSelect from &#x27;@/components/LangSelect&#x27;<br>import SocialSign from &#x27;./components/SocialSignin&#x27;<br><br>export default &#123;<br>  // ...<br>  methods: &#123;    <br>    handleLogin() &#123;<br>      this.$refs.loginForm.validate(valid =&gt; &#123;<br>        if (valid) &#123;<br>          this.loading = true<br>          this.$store.dispatch(&#x27;user/login&#x27;, this.loginForm)<br>            .then(() =&gt; &#123;<br>              this.$router.push(&#123; path: this.redirect || &#x27;/&#x27;, query: this.otherQuery &#125;)<br>              this.loading = false<br>            &#125;)<br>            .catch(() =&gt; &#123;<br>              this.loading = false<br>            &#125;)<br>        &#125; else &#123;<br>          console.log(&#x27;error submit!!&#x27;)<br>          return false<br>        &#125;<br>      &#125;)<br>    &#125;<br>    // ...<br>  &#125;<br>&#125;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<p>这里调用了 store 的 actions，<code>user/login</code></p>
<ul>
<li>因为是异步调用，因此只能用 actions</li>
<li>登录成功会优先跳转至 this.redirect 路径、否则跳转至 &#x2F;</li>
<li>&#x2F; 查看 <code>src/router/index.js</code> 的路由表可知，会重定向至 &#x2F;dashboard</li>
</ul>
<h4 id="2-src-store-modules-user-js"><a href="#2-src-store-modules-user-js" class="headerlink" title="2. src/store/modules/user.js"></a>2. <code>src/store/modules/user.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; login, logout, getInfo &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/api/user&#x27;</span><br><span class="hljs-comment">// ...</span><br><span class="hljs-keyword">const</span> actions = &#123;<br>  <span class="hljs-comment">// user login</span><br>  <span class="hljs-title function_">login</span>(<span class="hljs-params">&#123; commit &#125;, userInfo</span>) &#123;<br>    <span class="hljs-keyword">const</span> &#123; username, password &#125; = userInfo<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>      <span class="hljs-title function_">login</span>(&#123; <span class="hljs-attr">username</span>: username.<span class="hljs-title function_">trim</span>(), <span class="hljs-attr">password</span>: password &#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;<br>        <span class="hljs-keyword">const</span> &#123; data &#125; = response<br>        <span class="hljs-title function_">commit</span>(<span class="hljs-string">&#x27;SET_TOKEN&#x27;</span>, data.<span class="hljs-property">token</span>)<br>        <span class="hljs-title function_">setToken</span>(data.<span class="hljs-property">token</span>)<br>        <span class="hljs-title function_">resolve</span>()<br>      &#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;<br>        <span class="hljs-title function_">reject</span>(error)<br>      &#125;)<br>    &#125;)<br>  &#125;<br>  <span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>发请求用了 <code>src/api/user.js</code>，请求成功使用 commit 将 token 存入 mutations，同时往 cookie 存储了一份</li>
<li>这里的 response 其实是真正的 response.data，见后面的说明</li>
<li>评价<ul>
<li>向 cookie 或 sessionStorage 存储 token 即可，token 无需做成响应式，不必放入 store</li>
<li>作者使用了 Promise API，其实可以改变为 await 方式，提高可读性</li>
</ul>
</li>
</ul>
<h4 id="3-src-api-user-js"><a href="#3-src-api-user-js" class="headerlink" title="3. src/api/user.js"></a>3. <code>src/api/user.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> request <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/utils/request&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">login</span>(<span class="hljs-params">data</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;/user/login&#x27;</span>,<br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;post&#x27;</span>,<br>    data<br>  &#125;)<br>&#125;<br><br><span class="hljs-comment">// ...</span><br></code></pre></td></tr></table></figure>

<ul>
<li>其中 request 相当于我们之前封装的 myaxios</li>
</ul>
<h4 id="4-src-utils-request-js"><a href="#4-src-utils-request-js" class="headerlink" title="4. src/utils/request.js"></a>4. <code>src/utils/request.js</code></h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">MessageBox</span>, <span class="hljs-title class_">Message</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;element-ui&#x27;</span><br><span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/store&#x27;</span><br><span class="hljs-keyword">import</span> &#123; getToken &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/utils/auth&#x27;</span><br><br><span class="hljs-comment">// create an axios instance</span><br><span class="hljs-keyword">const</span> service = axios.<span class="hljs-title function_">create</span>(&#123;<br>  <span class="hljs-attr">baseURL</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">VUE_APP_BASE_API</span>, <span class="hljs-comment">// url = base url + request url</span><br>  <span class="hljs-comment">// withCredentials: true, // send cookies when cross-domain requests</span><br>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">5000</span> <span class="hljs-comment">// request timeout</span><br>&#125;)<br><br><span class="hljs-comment">// ... </span><br><br>service.<span class="hljs-property">interceptors</span>.<span class="hljs-property">response</span>.<span class="hljs-title function_">use</span>(<br>  <span class="hljs-comment">// ...</span><br>  <span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> res = response.<span class="hljs-property">data</span><br>    <span class="hljs-keyword">if</span> (res.<span class="hljs-property">code</span> !== <span class="hljs-number">20000</span>) &#123;<br>      <span class="hljs-comment">// ...</span><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">return</span> res<br>    &#125;<br>  &#125;,<br>  <span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;<br>    <span class="hljs-comment">// ...</span><br>  &#125;<br>)<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> service<br></code></pre></td></tr></table></figure>

<ul>
<li>其中响应拦截器发现响应正确，返回 resp.data 这样，其它处代码解构时少了一层 data</li>
</ul>
<h4 id="5-src-permission-js"><a href="#5-src-permission-js" class="headerlink" title="5. src/permission.js"></a>5. <code>src/permission.js</code></h4><p>登录成功后，只是获得了 token，还未获取用户信息，获取用户信息是在路由跳转的 beforeEach 里做的</p>
<pre><code class=" mermaid">sequenceDiagram 

participant c as 登录页
participant r as Router
participant s as Store
participant t as Tomcat

rect rgba(255,0,0,0.2)
c -&gt;&gt; +s: login(username,password)
s -&gt;&gt; +t: login(username,password)
t --&gt;&gt; -s: token
s -&gt;&gt; s: 存储 token
s --&gt;&gt; -c: 
end

rect rgba(0,255,0,0.2)
c -&gt;&gt; +r: 跳转至 /
r -&gt;&gt; +s: beforeEach getInfo(token)
s -&gt;&gt; +t: getInfo(token)
t --&gt;&gt; -s: name,avatar,roles等
s -&gt;&gt; s: 存储用户信息
s --&gt;&gt; -r: 
r -&gt;&gt; r: 根据roles动态生成路由
r --&gt;&gt; -c: 
end

</code></pre>

<p>关键代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./router&#x27;</span><br><br><span class="hljs-comment">// ...</span><br><br>router.<span class="hljs-title function_">beforeEach</span>(<span class="hljs-title function_">async</span>(to, <span class="hljs-keyword">from</span>, next) =&gt; &#123;<br>  <span class="hljs-comment">// ...</span><br>  <span class="hljs-keyword">const</span> hasToken = <span class="hljs-title function_">getToken</span>()<br><br>  <span class="hljs-keyword">if</span> (hasToken) &#123;<br>    <span class="hljs-keyword">if</span> (to.<span class="hljs-property">path</span> === <span class="hljs-string">&#x27;/login&#x27;</span>) &#123;<br>      <span class="hljs-comment">// ...</span><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-comment">// ...</span><br>      <span class="hljs-keyword">const</span> &#123; roles &#125; = <span class="hljs-keyword">await</span> store.<span class="hljs-title function_">dispatch</span>(<span class="hljs-string">&#x27;user/getInfo&#x27;</span>)<br>      <span class="hljs-comment">// ...</span><br>    &#125;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">// ...</span><br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>

<ul>
<li>登录后跳转至 &#x2F; 之前进入这里的 beforeEach 方法，方法内主要做两件事<ul>
<li>一是调用 actions 方法获取用户角色，见 6</li>
<li>二是根据用户角色，动态生成路由，见 7</li>
</ul>
</li>
</ul>
<h4 id="6-src-store-modules-user-js"><a href="#6-src-store-modules-user-js" class="headerlink" title="6. src/store/modules/user.js"></a>6. <code>src/store/modules/user.js</code></h4><p>这里用其中 getInfo 方法获取用户信息，其中角色返回给 beforeEach </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; login, logout, getInfo &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/api/user&#x27;</span><br><span class="hljs-comment">// ...</span><br><span class="hljs-keyword">const</span> actions = &#123;<br>  <span class="hljs-title function_">getInfo</span>(<span class="hljs-params">&#123; commit, state &#125;</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>      <span class="hljs-title function_">getInfo</span>(state.<span class="hljs-property">token</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;<br>        <span class="hljs-keyword">const</span> &#123; data &#125; = response<br><br>        <span class="hljs-keyword">if</span> (!data) &#123;<br>          <span class="hljs-title function_">reject</span>(<span class="hljs-string">&#x27;Verification failed, please Login again.&#x27;</span>)<br>        &#125;<br><br>        <span class="hljs-keyword">const</span> &#123; roles, name, avatar, introduction &#125; = data<br><br>        <span class="hljs-keyword">if</span> (!roles || roles.<span class="hljs-property">length</span> &lt;= <span class="hljs-number">0</span>) &#123;<br>          <span class="hljs-title function_">reject</span>(<span class="hljs-string">&#x27;getInfo: roles must be a non-null array!&#x27;</span>)<br>        &#125;<br><br>        <span class="hljs-title function_">commit</span>(<span class="hljs-string">&#x27;SET_ROLES&#x27;</span>, roles)<br>        <span class="hljs-title function_">commit</span>(<span class="hljs-string">&#x27;SET_NAME&#x27;</span>, name)<br>        <span class="hljs-title function_">commit</span>(<span class="hljs-string">&#x27;SET_AVATAR&#x27;</span>, avatar)<br>        <span class="hljs-title function_">commit</span>(<span class="hljs-string">&#x27;SET_INTRODUCTION&#x27;</span>, introduction)<br>        <span class="hljs-title function_">resolve</span>(data)<br>      &#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;<br>        <span class="hljs-title function_">reject</span>(error)<br>      &#125;)<br>    &#125;)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>





<h4 id="7-src-router-index-js"><a href="#7-src-router-index-js" class="headerlink" title="7. src/router/index.js"></a>7. <code>src/router/index.js</code></h4><p>路由表中路由分成两部分，静态路由与动态路由</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> constantRoutes = [<br>  <span class="hljs-comment">// ...</span><br>  &#123;<br>    <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/login&#x27;</span>,<br>    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/login/index&#x27;</span>),<br>    <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span><br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/&#x27;</span>,<br>    <span class="hljs-attr">component</span>: <span class="hljs-title class_">Layout</span>,<br>    <span class="hljs-attr">redirect</span>: <span class="hljs-string">&#x27;/dashboard&#x27;</span>,<br>    <span class="hljs-attr">children</span>: [<br>      &#123;<br>        <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;dashboard&#x27;</span>,<br>        <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/dashboard/index&#x27;</span>),<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Dashboard&#x27;</span>,<br>        <span class="hljs-attr">meta</span>: &#123; <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;dashboard&#x27;</span>, <span class="hljs-attr">icon</span>: <span class="hljs-string">&#x27;dashboard&#x27;</span>, <span class="hljs-attr">affix</span>: <span class="hljs-literal">true</span> &#125;<br>      &#125;<br>    ]<br>  &#125;<br>  <span class="hljs-comment">// ...</span><br>]<br></code></pre></td></tr></table></figure>

<ul>
<li>其中 hidden: true 的路由只做路由跳转，不会在左侧导航菜单展示</li>
</ul>
<p>动态路由</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> asyncRoutes = [<br>  &#123;<br>    <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/permission&#x27;</span>,<br>    <span class="hljs-attr">component</span>: <span class="hljs-title class_">Layout</span>,<br>    <span class="hljs-attr">redirect</span>: <span class="hljs-string">&#x27;/permission/page&#x27;</span>,<br>    <span class="hljs-attr">alwaysShow</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// will always show the root menu</span><br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Permission&#x27;</span>,<br>    <span class="hljs-attr">meta</span>: &#123;<br>      <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;permission&#x27;</span>,<br>      <span class="hljs-attr">icon</span>: <span class="hljs-string">&#x27;lock&#x27;</span>,<br>      <span class="hljs-attr">roles</span>: [<span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;editor&#x27;</span>] <span class="hljs-comment">// you can set roles in root nav</span><br>    &#125;,<br>    <span class="hljs-attr">children</span>: [<br>      &#123;<br>        <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;page&#x27;</span>,<br>        <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/permission/page&#x27;</span>),<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;PagePermission&#x27;</span>,<br>        <span class="hljs-attr">meta</span>: &#123;<br>          <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;pagePermission&#x27;</span>,<br>          <span class="hljs-attr">roles</span>: [<span class="hljs-string">&#x27;admin&#x27;</span>] <span class="hljs-comment">// or you can only set roles in sub nav</span><br>        &#125;<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;directive&#x27;</span>,<br>        <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/permission/directive&#x27;</span>),<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;DirectivePermission&#x27;</span>,<br>        <span class="hljs-attr">meta</span>: &#123;<br>          <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;directivePermission&#x27;</span><br>          <span class="hljs-comment">// if do not set roles, means: this page does not require permission</span><br>        &#125;<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;role&#x27;</span>,<br>        <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/permission/role&#x27;</span>),<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;RolePermission&#x27;</span>,<br>        <span class="hljs-attr">meta</span>: &#123;<br>          <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;rolePermission&#x27;</span>,<br>          <span class="hljs-attr">roles</span>: [<span class="hljs-string">&#x27;admin&#x27;</span>]<br>        &#125;<br>      &#125;<br>    ]<br>  &#125;,<br><br>  &#123;<br>    <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/icon&#x27;</span>,<br>    <span class="hljs-attr">component</span>: <span class="hljs-title class_">Layout</span>,<br>    <span class="hljs-attr">children</span>: [<br>      &#123;<br>        <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;index&#x27;</span>,<br>        <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/icons/index&#x27;</span>),<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Icons&#x27;</span>,<br>        <span class="hljs-attr">meta</span>: &#123; <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;icons&#x27;</span>, <span class="hljs-attr">icon</span>: <span class="hljs-string">&#x27;icon&#x27;</span>, <span class="hljs-attr">noCache</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">roles</span>: [<span class="hljs-string">&#x27;admin&#x27;</span>] &#125;<br>      &#125;<br>    ]<br>  &#125;<br>  <span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>动态路由中关联了角色信息，根据用户的角色决定那些路由可用，但这样做的缺点是把角色和路由绑定死了</li>
</ul>
<h4 id="8-src-layout-index-vue"><a href="#8-src-layout-index-vue" class="headerlink" title="8. src/layout/index.vue"></a>8. <code>src/layout/index.vue</code></h4><p>它对应的是我们之前介绍的 Container.vue 完成主页布局的，路由路径是 &#x2F;</p>
<p><img src="https://zhao1129.oss-cn-qingdao.aliyuncs.com/img/202303261550160.png" srcset="https://zhao1129.oss-cn-qingdao.aliyuncs.com/img/202209301019837.jpeg" lazyload alt="image-20220827194047788"></p>
<p>其中又由多部分组成，其中固定不变的是</p>
<ul>
<li>侧边栏</li>
<li>导航栏</li>
<li>标签栏</li>
<li>设置</li>
</ul>
<p>变化的是中间的 dashboard 部分（AppMain），它由 router-view 配合子路由切换显示</p>
<ul>
<li>进入 &#x2F; 后，就会 redirect 重定向到 &#x2F;dashboard 子路由</li>
<li>进入首页后，会有一个 <code>/api/transaction/list</code> 的后台请求报 404，作为练习，把它补充完整</li>
</ul>
<h3 id="第三方登录"><a href="#第三方登录" class="headerlink" title="第三方登录"></a>第三方登录</h3><pre><code class=" mermaid">sequenceDiagram
participant a7 as 前端(9527)
participant a8 as 后端(8080)
participant g as gitee

rect rgba(0,255,0,0.2) 
a7 -&gt;&gt; +g: 打开新窗口, 请求 /oauth/authorize
g -&gt;&gt; g: 认证通过
end
rect rgba(255,0,0,0.2)
g -&gt;&gt; -a8: 重定向 redirect uri
end
rect rgba(0,255,0,0.2)
a8 -&gt;&gt; +g: 请求 /oauth/token
g -&gt;&gt; -a8: 返回 access_token(gitee)
end
rect rgba(0,255,0,0.2)
a8 -&gt;&gt; +g: 请求 /api/v5/user
g --&gt;&gt; -a8: 
end
a8 -&gt;&gt; 8: 生成 token(8080)
rect rgba(0,0,255,0.2)
a8 -&gt;&gt; +a7: 新窗口将 token(8080) 发送给老窗口(9527)
end
</code></pre>

<ol>
<li><p>9527 打开新窗口，请求 <code>https://gitee.com/oauth/authorize?client_id=$&#123;client_id&#125;&amp;redirect_uri=$&#123;redirect_uri&#125;&amp;response_type=code</code></p>
</li>
<li><p>gitee 认证通过，重定向至 8080，并携带 code</p>
</li>
<li><p>8080 发送请求 <code>https://gitee.com/oauth/token</code> 携带 client_id、client_secret、code，gitee 返回 access_token 给 8080</p>
<ul>
<li><p>这时走的是 https 协议，并且不经过浏览器，能够保证数据传输的安全性</p>
</li>
<li><p>重定向到 8080 时，如果被有心人拿到了 code，也没事，因为接下来会把 client_secret 发给 gitee 验证（client_secret 应当只存在 8080），只要 client_secret 不泄露，就可以保证安全</p>
</li>
<li><p>如果改成前端拿 code 换 access_token，那就意味着 access_token 得保存在前端，所有保存在前端的都有风险</p>
</li>
</ul>
</li>
<li><p>8080 可以访问 gitee 的 api 了，拿到用户信息，存入数据库，返回 8080 的 token</p>
</li>
<li><p>8080 可以通过 window.opener.postMessage 把 token 给 9527 的老窗口</p>
<ul>
<li>这里又会涉及到跨域，不过 9527 与 8080 直接存在信任关系，设置一下就好</li>
</ul>
</li>
<li><p>9527 再走之前的逻辑就可以了，在 router 的 beforeEach 方法里，用 8080 token 换用户信息</p>
</li>
</ol>
<h3 id="增删改查"><a href="#增删改查" class="headerlink" title="增删改查"></a>增删改查</h3><p>首先，在 api 里添加与后端交互的代码：<code>src/api/student.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/utils/request&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">all</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">axios</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;/students&#x27;</span>,<br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;get&#x27;</span><br>  &#125;)<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">deleteById</span>(<span class="hljs-params">id</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">axios</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">`/students/<span class="hljs-subst">$&#123;id&#125;</span>`</span>,<br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;delete&#x27;</span><br>  &#125;)<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">id, dto</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">axios</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">`/students/<span class="hljs-subst">$&#123;id&#125;</span>`</span>,<br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;put&#x27;</span>,<br>    <span class="hljs-attr">data</span>: dto<br>  &#125;)<br>&#125;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">insert</span>(<span class="hljs-params">dto</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">axios</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">`/students`</span>,<br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;post&#x27;</span>,<br>    <span class="hljs-attr">data</span>: dto<br>  &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>然后，添加新的路由：<code>src/router/index.js</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> asyncRoutes = [<br>  <span class="hljs-comment">// ...</span><br>  &#123;<br>    <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/student&#x27;</span>,<br>    <span class="hljs-attr">component</span>: <span class="hljs-title class_">Layout</span>,<br>    <span class="hljs-attr">children</span>: [<br>      &#123;<br>        <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;index&#x27;</span>,<br>        <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/student/index&#x27;</span>),<br>        <span class="hljs-attr">meta</span>: &#123; <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;学生管理&#x27;</span>, <span class="hljs-attr">icon</span>: <span class="hljs-string">&#x27;el-icon-s-help&#x27;</span>, <span class="hljs-attr">roles</span>: [<span class="hljs-string">&#x27;admin&#x27;</span>] &#125;<br>      &#125;<br>    ]<br>  &#125;,<br>  <span class="hljs-comment">// ...</span><br>]<br></code></pre></td></tr></table></figure>

<ul>
<li>注意 title 这里没有考虑国际化</li>
</ul>
<p>最后，添加新的视图界面：<code>src/views/student/index.vue</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div&gt;<br>    &lt;el-table :data=&quot;students&quot;&gt;<br>      &lt;el-table-column label=&quot;编号&quot; prop=&quot;id&quot;&gt;&lt;/el-table-column&gt;<br>      &lt;el-table-column label=&quot;姓名&quot; prop=&quot;name&quot;&gt;&lt;/el-table-column&gt;<br>      &lt;el-table-column label=&quot;性别&quot; prop=&quot;sex&quot;&gt;&lt;/el-table-column&gt;<br>      &lt;el-table-column label=&quot;年龄&quot; prop=&quot;age&quot;&gt;&lt;/el-table-column&gt;<br>      &lt;el-table-column fixed=&quot;right&quot; label=&quot;操作&quot; width=&quot;100&quot;&gt;<br>        &lt;template slot-scope=&quot;scope&quot;&gt;<br>          &lt;el-button @click=&quot;handleUpdate(scope.row)&quot; type=&quot;text&quot; size=&quot;small&quot;&gt;修改&lt;/el-button&gt;<br>          &lt;el-button @click=&quot;handleDelete(scope.row)&quot; type=&quot;text&quot; size=&quot;small&quot;&gt;删除&lt;/el-button&gt;<br>        &lt;/template&gt;<br>      &lt;/el-table-column&gt;<br>    &lt;/el-table&gt;<br><br>    &lt;el-dialog width=&quot;22%&quot; :visible.sync=&quot;updateDialogVisible&quot;&gt;<br>      &lt;el-form :model=&quot;updateForm&quot;&gt;<br>        &lt;el-form-item label=&quot;编号&quot;&gt;<br>          &lt;el-input size=&quot;mini&quot; :readonly=&quot;true&quot; v-model=&quot;updateForm.id&quot;&gt;&lt;/el-input&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;姓名&quot;&gt;<br>          &lt;el-input size=&quot;mini&quot; v-model=&quot;updateForm.name&quot;&gt;&lt;/el-input&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;性别&quot;&gt;<br>          &lt;el-select size=&quot;mini&quot; v-model=&quot;updateForm.sex&quot;&gt;<br>            &lt;el-option value=&quot;男&quot;&gt;&lt;/el-option&gt;<br>            &lt;el-option value=&quot;女&quot;&gt;&lt;/el-option&gt;<br>          &lt;/el-select&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;年龄&quot;&gt;<br>          &lt;el-input size=&quot;mini&quot; v-model=&quot;updateForm.age&quot;&gt;&lt;/el-input&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item&gt;<br>          &lt;el-button type=&quot;primary&quot; size=&quot;mini&quot; @click=&quot;confirmUpdate()&quot;&gt;确定&lt;/el-button&gt;<br>        &lt;/el-form-item&gt;<br>      &lt;/el-form&gt;<br>    &lt;/el-dialog&gt;<br>  &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;script&gt;<br>import &#123; all, deleteById, update, insert &#125; from &#x27;@/api/student&#x27;<br>const options = &#123;<br>  mounted() &#123;<br>    this.all()<br>  &#125;,<br>  data() &#123;<br>    return &#123;<br>      students: [],<br>      updateDialogVisible: false,<br>      updateForm: &#123;<br>        id: 0,<br>        name: &#x27;&#x27;,<br>        sex: &#x27;男&#x27;,<br>        age: 0<br>      &#125;<br>    &#125;<br>  &#125;,<br>  methods: &#123;<br>    async confirmUpdate() &#123;<br>      await update(this.updateForm.id, this.updateForm)<br>      this.updateDialogVisible = false<br>      this.all()<br>    &#125;,<br>    handleUpdate(row) &#123; // &#123;id, name, sex, age&#125;<br>      this.updateDialogVisible = true<br>      this.updateForm = &#123; ...row &#125;<br>      // this.updateForm = row // 错误写法，不能让他俩指向同一个对象<br>    &#125;,<br>    async handleDelete(row) &#123;<br>      try &#123;<br>        await this.$confirm(&#x27;此操作将永久删除该学生, 是否继续?&#x27;, &#x27;提示&#x27;, &#123;<br>          confirmButtonText: &#x27;确定&#x27;,<br>          cancelButtonText: &#x27;取消&#x27;,<br>          type: &#x27;warning&#x27;<br>        &#125;)<br>        await deleteById(row.id)<br>        this.all()<br>      &#125; catch (e) &#123;<br>        console.log(&#x27;取消删除&#x27;)<br>      &#125;<br>    &#125;,<br>    async all() &#123;<br>      const &#123; data &#125; = await all()<br>      this.students = data<br>    &#125;<br>  &#125;<br>&#125;<br>export default options<br>&lt;/script&gt;<br>&lt;style scoped&gt;<br>.el-input,<br>.el-select &#123;<br>  width: 180px;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure>

<ul>
<li>其中 handleUpdate 和 handleDelete 接收的参数，都是代表了当前行的学生对象</li>
</ul>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>vue2</div>
      <div>http://example.com/2022/09/29/vue2/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>September 29, 2022</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/09/29/springmvc/" title="SpringMVC">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">SpringMVC</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/09/29/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" title="数据结构与算法">
                        <span class="hidden-mobile">数据结构与算法</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;Table of Contents</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    
      <script  src="/js/img-lazyload.js" ></script>
    
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
